<html class="gr__ruder_io"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>An overview of gradient descent optimization algorithms</title>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">



<link rel="apple-touch-icon" sizes="57x57" href="http://ruder.io/assets/img/apple-touch-icon-57x57.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="60x60" href="http://ruder.io/assets/img/apple-touch-icon-60x60.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="72x72" href="http://ruder.io/assets/img/apple-touch-icon-72x72.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="76x76" href="http://ruder.io/assets/img/apple-touch-icon-76x76.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="114x114" href="http://ruder.io/assets/img/apple-touch-icon-114x114.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="120x120" href="http://ruder.io/assets/img/apple-touch-icon-120x120.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="144x144" href="http://ruder.io/assets/img/apple-touch-icon-144x144.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="152x152" href="http://ruder.io/assets/img/apple-touch-icon-152x152.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="180x180" href="http://ruder.io/assets/img/apple-touch-icon-180x180.png?v=wAAv6Wqe6l">
<link rel="icon" type="image/png" href="http://ruder.io/assets/img/favicon-32x32.png?v=wAAv6Wqe6l" sizes="32x32">
<link rel="icon" type="image/png" href="http://ruder.io/assets/img/favicon-194x194.png?v=wAAv6Wqe6l" sizes="194x194">
<link rel="icon" type="image/png" href="http://ruder.io/assets/img/favicon-96x96.png?v=wAAv6Wqe6l" sizes="96x96">
<link rel="icon" type="image/png" href="http://ruder.io/assets/img/android-chrome-192x192.png?v=wAAv6Wqe6l" sizes="192x192">
<link rel="icon" type="image/png" href="http://ruder.io/assets/img/favicon-16x16.png?v=wAAv6Wqe6l" sizes="16x16">
<link rel="manifest" href="http://ruder.io/assets/img/manifest.json?v=wAAv6Wqe6l">
<link rel="shortcut icon" href="http://ruder.io/assets/img/favicon.ico?v=wAAv6Wqe6l">
<meta name="msapplication-TileColor" content="#e74c3c">
<meta name="msapplication-TileImage" content="/assets/img/mstile-144x144.png?v=wAAv6Wqe6l">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml?v=wAAv6Wqe6l">
<meta name="theme-color" content="#e74c3c">
    <link rel="stylesheet" type="text/css" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/uno-zen.css">
    <link rel="canonical" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a_003.html">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="Sebastian Ruder">
    <meta property="og:type" content="article">
    <meta property="og:title" content="An overview of gradient descent optimization algorithms">
    <meta property="og:description" content="This blog post looks at variants of gradient descent and the algorithms that are commonly used to optimize them.">
    <meta property="og:url" content="u=http://ruder.io/optimizing-gradient-descent/">
    <meta property="og:image" content="u=http://ruder.io/content/images/2016/09/loss_function_image_tumblr.png">
    <meta property="article:published_time" content="2016-01-19T14:20:00.000Z">
    <meta property="article:modified_time" content="2018-02-13T14:36:27.816Z">
    <meta property="article:tag" content="optimization">
    <meta property="article:tag" content="deep learning">
    <meta property="article:tag" content="sgd">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="An overview of gradient descent optimization algorithms">
    <meta name="twitter:description" content="This blog post looks at variants of gradient descent and the algorithms that are commonly used to optimize them.">
    <meta name="twitter:url" content="u=http://ruder.io/optimizing-gradient-descent/">
    <meta name="twitter:image:src" content="u=http://ruder.io/content/images/2016/09/loss_function_image_tumblr.png">
    
    <script async="" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/analytics.js"></script><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Sebastian Ruder",
    "author": {
        "@type": "Person",
        "name": "Sebastian Ruder",
        "url": "u=http://ruder.io/author/sebastian",
        "sameAs": null,
        "description": null
    },
    "headline": "An overview of gradient descent optimization algorithms",
    "url": "u=http://ruder.io/optimizing-gradient-descent/",
    "datePublished": "2016-01-19T14:20:00.000Z",
    "dateModified": "2018-02-13T14:36:27.816Z",
    "image": "u=http://ruder.io/content/images/2016/09/loss_function_image_tumblr.png",
    "keywords": "optimization, deep learning, sgd",
    "description": "This blog post looks at variants of gradient descent and the algorithms that are commonly used to optimize them."
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="Sebastian Ruder" href="http://ruder.io/rss/">
    <script>
var open_button = '.nav-blog > a'
</script>
<script>
var profile_title = 'Sebastian Ruder';
</script>
<script>
var disqus_shortname = 'sebastianruder';
</script>
<script>
var profile_resume ='NLP PhD student';
</script>
<script>
var ga_id = 'UA-60512592-1';
</script>
  <script type="text/javascript" async="" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/embed.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link rel="prefetch" as="style" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a_data/lounge.css"><link rel="prefetch" as="script" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a_data/common.js"><link rel="prefetch" as="script" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a_data/lounge.js"><link rel="prefetch" as="script" href="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a_data/config.js"><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
  <body class="post-template tag-optimization tag-deep-learning tag-sgd  pace-done" data-gr-c-s-loaded="true" data-page="post" data-device="tablet"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div class="pace  pace-inactive"><div class="pace-progress" style="transform: translate3d(100%, 0px, 0px);" data-progress-text="100%" data-progress="99">
  <div class="pace-progress-inner"></div>
</div>
<div class="pace-activity"></div></div><div id="MathJax_Message" style="display: none;"></div>
    <header id="menu-button" class="expanded">
      <a><i class="icon icon-list"></i></a>
    </header>
    <aside class="cover" style="background: url(../content/images/2017/05/imageedit_8_8459453433.jpg) center/cover no-repeat fixed">
  <div class="cover container">
    <div class="profile">
      <a id="avatar-link" title="link to homepage for Sebastian Ruder" href="http://ruder.io/#open">
        <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/Seb_LinkedIn_Profile-.png" alt="Sebastian Ruder avatar" class="profile avatar rounded hvr-buzz-out">
        <h1 id="profile-title">Sebastian Ruder</h1>
        <h3 id="profile-resume">NLP PhD student</h3>
      </a>

      <hr class="divider long">
      <p>I'm a PhD student in Natural Language Processing and a research
 scientist at AYLIEN. I blog about Machine Learning, Deep Learning, NLP,
 and startups.</p>
      <hr class="divider short">
      <div class="navigation">
        <div class="profile contact">
          <nav class="navigation left">
  <ul class="links">
      <li class="nav-blog ">
        <a href="http://ruder.io/">Blog</a>
      </li>
      <li class="nav-about ">
        <a href="http://ruder.io/about/">About</a>
      </li>
      <li class="nav-papers ">
        <a href="http://ruder.io/publications/">Papers</a>
      </li>
      <li class="nav-news ">
        <a href="http://ruder.io/news">News</a>
      </li>
      <li class="nav-newsletter ">
        <a href="http://newsletter.ruder.io/">Newsletter</a>
      </li>
      <li class="nav-faq ">
        <a href="http://ruder.io/faq">FAQ</a>
      </li>
  </ul>
</nav>

          
<nav class="navigation right">
  <ul class="social expanded">

  <!-- Twitter -->
  <li class="social item hvr-grow-rotate">
    <a rel="me" target="blank" href="http://twitter.com/seb_ruder" title="@seb_ruder on Twitter">
      <i class="icon icon-social-twitter"></i>
      <span class="label">Twitter</span>
    </a>
  </li>

  <!-- Linkedin -->
  <li class="social item hvr-grow-rotate">
    <a rel="me" target="blank" href="https://www.linkedin.com/in/sebastianruder" title="sebastianruder on LinkedIn">
      <i class="icon icon-social-linkedin"></i>
      <span class="label">Linkedin</span>
    </a>
  </li>

  <!-- Github -->
  <li class="social item hvr-grow-rotate">
    <a rel="me" target="blank" href="https://github.com/sebastianruder" title="sebastianruder on Github">
      <i class="icon icon-social-github"></i>
      <span class="label">Github</span>
    </a>
  </li>

  <!-- E-mail -->
  <li class="social item hvr-grow-rotate">
    <a rel="me" target="blank" href="mailto:sebastian@ruder.io" title="send me an email">
      <i class="icon icon-mail"></i>
      <span class="label">Email</span>
    </a>
  </li>

  <!-- RSS -->
  <li class="social item hvr-grow-rotate">
    <a href="http://ruder.io/rss/index.rss" title="Subscribe to RSS">
      <i class="icon icon-rss"></i>
      <span class="label">RSS</span>
    </a>
  </li>

  </ul>
</nav>
          <section class="icon icon-search" id="search-container">
  <hr class="divider short">
  <form id="search-form" action="https://www.google.com/#q=site:u=http://ruder.io">
    <input name="search" placeholder="Deep Learning, NLP, ..." id="search-field" type="text">
  </form>
</section>
        </div>
      </div>
    </div>
  </div>
</aside>
    <main>
      <section id="search-results"></section>
      <section class="content">
        

  <article class="post tag-optimization tag-deep-learning tag-sgd">
    <header>
      <div class="post meta">
        <time datetime="19 Jan 2016">19 Jan 2016</time>
        <span class="post tags">in <a href="http://ruder.io/tag/optimization/">optimization</a> <a href="http://ruder.io/tag/deep-learning/">deep learning</a> <a href="http://ruder.io/tag/sgd/">sgd</a></span>


        <span class="post reading-time"> ~ <span>25 min</span> read.</span>
      </div>
      <a alt="Tweet 'An overview of gradient descent optimization algorithms'" href="https://twitter.com/intent/tweet?text=An%20overview%20of%20gradient%20descent%20optimization%20algorithms%20%C2%BB&amp;hashtags=optimization,deep%20learning,sgd&amp;url=http://ruder.io/optimizing-gradient-descent/">
        <img id="post-image" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/loss_function_image_tumblr.png" alt="An overview of gradient descent optimization algorithms">
        <h1 class="icon-reverse icon-social-twitter-post" id="post-title">An overview of gradient descent optimization algorithms</h1>
      </a>
    </header>

    <div id="post-content" class="post tag-optimization tag-deep-learning tag-sgd">
      <p>Note: If you are looking for a review paper, this blog post is also available as an <a href="http://arxiv.org/abs/1609.04747">article on arXiv</a>.</p>

<p>Update 15.06.2017: Added derivations of <a href="http://ruder.io/optimizing-gradient-descent/index.html#adamax">AdaMax</a> and <a href="http://ruder.io/optimizing-gradient-descent/index.html#nadam">Nadam</a>.</p>

<p>Update 24.11.2017: Most of the content in this article is now also available as <a href="https://www.slideshare.net/SebastianRuder/optimization-for-deep-learning">slides</a>.</p>

<p>Update 09.02.2018: Added <a href="http://ruder.io/optimizing-gradient-descent/index.html#amsgrad">AMSGrad</a>.</p>

<p>Table of contents:</p>

<ul>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#gradientdescentvariants">Gradient descent variants</a>
<ul><li><a href="http://ruder.io/optimizing-gradient-descent/index.html#batchgradientdescent">Batch gradient descent</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#stochasticgradientdescent">Stochastic gradient descent</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#minibatchgradientdescent">Mini-batch gradient descent</a></li></ul></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#challenges">Challenges</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#gradientdescentoptimizationalgorithms">Gradient descent optimization algorithms</a>
<ul><li><a href="http://ruder.io/optimizing-gradient-descent/index.html#momentum">Momentum</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#nesterovacceleratedgradient">Nesterov accelerated gradient</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#adagrad">Adagrad</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#adadelta">Adadelta</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#rmsprop">RMSprop</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#adam">Adam</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#adamax">AdaMax</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#nadam">Nadam</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#amsgrad">AMSGrad</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#visualizationofalgorithms">Visualization of algorithms</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#whichoptimizertochoose">Which optimizer to choose?</a></li></ul></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#parallelizinganddistributingsgd">Parallelizing and distributing SGD</a>
<ul><li><a href="http://ruder.io/optimizing-gradient-descent/index.html#hogwild">Hogwild!</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#downpoursgd">Downpour SGD</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#delaytolerantalgorithmsforsgd">Delay-tolerant Algorithms for SGD</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#tensorflow">TensorFlow</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#elasticaveragingsgd">Elastic Averaging SGD</a></li></ul></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#additionalstrategiesforoptimizingsgd">Additional strategies for optimizing SGD</a>
<ul><li><a href="http://ruder.io/optimizing-gradient-descent/index.html#shufflingandcurriculumlearning">Shuffling and Curriculum Learning</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#batchnormalization">Batch normalization</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#earlystopping">Early Stopping</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#gradientnoise">Gradient noise</a></li></ul></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#conclusion">Conclusion</a></li>
<li><a href="http://ruder.io/optimizing-gradient-descent/index.html#references">References</a></li>
</ul>

<p>Gradient descent is one of the most popular algorithms to perform 
optimization and by far the most common way to optimize neural networks.
 At the same time, every state-of-the-art Deep Learning library contains
 implementations of various algorithms to optimize gradient descent 
(e.g. <a href="http://lasagne.readthedocs.org/en/latest/modules/updates.html">lasagne's</a>, <a href="http://caffe.berkeleyvision.org/tutorial/solver.html">caffe's</a>, and <a href="http://keras.io/optimizers/">keras'</a>
 documentation). These algorithms, however, are often used as black-box 
optimizers, as practical explanations of their strengths and weaknesses 
are hard to come by.</p>

<p>This blog post aims at providing you with intuitions towards the 
behaviour of different algorithms for optimizing gradient descent that 
will help you put them to use. We are first going to look at the 
different variants of gradient descent. We will then briefly summarize 
challenges during training. Subsequently, we will introduce the most 
common optimization algorithms by showing their motivation to resolve 
these challenges and how this leads to the derivation of their update 
rules. We will also take a short look at algorithms and architectures to
 optimize gradient descent in a parallel and distributed setting. 
Finally, we will consider additional strategies that are helpful for 
optimizing gradient descent.</p>

<p>Gradient descent is a way to minimize an objective function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.923em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.317em, 1001.83em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">J(\theta)</script> parameterized by a model's parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 3.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.885em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.215em, 1002.89em, 2.444em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.71em, 4.136em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-12"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.4em; left: 0.722em;"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.115em; border-left: 0px solid; width: 0px; height: 1.348em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">\theta \in \mathbb{R}^d </script> by updating the parameters in the opposite direction of the gradient of the objective function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 4.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.125em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.317em, 1003.03em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">\nabla_\theta J(\theta)</script> w.r.t. to the parameters. The learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">\eta</script>
 determines the size of the steps we take to reach a (local) minimum. In
 other words, we follow the direction of the slope of the surface 
created by the objective function downhill until we reach a valley. If 
you are unfamiliar with gradient descent, you can find a good 
introduction on optimizing neural networks <a href="http://cs231n.github.io/optimization-1/">here</a>.</p>

<h1 id="gradientdescentvariants">&nbsp;Gradient descent variants</h1>

<p>There are three variants of gradient descent, which differ in how 
much data we use to compute the gradient of the objective function. 
Depending on the amount of data, we make a trade-off between the 
accuracy of the parameter update and the time it takes to perform an 
update.</p>

<h2 id="batchgradientdescent">Batch gradient descent</h2>

<p>Vanilla gradient descent, aka batch gradient descent, computes the gradient of the cost function w.r.t. to the parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.122em, 1000.47em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\theta</script> for the entire training dataset:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 10.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.885em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.365em, 1007.79em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-39" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">\theta = \theta - \eta \cdot \nabla_\theta J( \theta)</script>.</p>

<p>As we need to calculate the gradients for the whole dataset to perform just <em>one</em>
 update, batch gradient descent can be very slow and is intractable for 
datasets that don't fit in memory. Batch gradient descent also doesn't 
allow us to update our model <em>online</em>, i.e. with new examples on-the-fly.</p>

<p>In code, batch gradient descent looks something like this:</p>

<pre class=" language-python"><code class=" language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>nb_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
  params_grad <span class="token operator">=</span> evaluate_gradient<span class="token punctuation">(</span>loss_function<span class="token punctuation">,</span> data<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
  params <span class="token operator">=</span> params <span class="token operator">-</span> learning_rate <span class="token operator">*</span> params_grad</code></pre>

<p>For a pre-defined number of epochs,  we first compute the gradient vector <code class=" language-python">params_grad</code> of the loss function for the whole dataset w.r.t. our parameter vector <code class=" language-python">params</code>.
  Note that state-of-the-art deep learning libraries provide automatic 
differentiation that efficiently computes the gradient w.r.t. some 
parameters. If you derive the gradients yourself, then gradient checking
 is a good idea. (See <a href="http://cs231n.github.io/neural-networks-3/">here</a> for some great tips on how to check gradients properly.)</p>

<p>We then update our parameters in the direction of the gradients with 
the learning rate determining how big of an update we perform. Batch 
gradient descent is guaranteed to converge to the global minimum for 
convex error surfaces and to a local minimum for non-convex surfaces.</p>

<h2 id="stochasticgradientdescent">Stochastic gradient descent</h2>

<p>Stochastic gradient descent (SGD) in contrast performs a parameter update for <em>each</em> training example <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 1.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.028em, 1001.44em, 1.165em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.52em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.572em;"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mo" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 1.3em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-7">x^{(i)}</script> and label <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.394em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.028em, 1001.39em, 1.359em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="msubsup" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.548em;"><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mo" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 1.553em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-8">y^{(i)}</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 15.147em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.635em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.222em, 1011.54em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-72" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-79" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.441em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.52em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.572em;"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-87" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.417em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.548em;"><span class="texatom" id="MathJax-Span-89"><span class="mrow" id="MathJax-Span-90"><span class="mo" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.611em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>;</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">\theta = \theta - \eta \cdot \nabla_\theta J( \theta; x^{(i)}; y^{(i)})</script>.</p>

<p>Batch gradient descent performs redundant computations for large 
datasets, as it recomputes gradients for similar examples before each 
parameter update. SGD does away with this redundancy by performing one 
update at a time. It is therefore usually much faster and can also be 
used to learn online. <br>
SGD performs frequent updates with a high variance that cause the objective function to fluctuate heavily as in Image 1.</p>

<figure>  
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/sgd_fluctuation.png" style="width: 50%; height: 50%" title="SGD fluctuation">
<figcaption>Image 1: SGD fluctuation (Source: <a href="https://upload.wikimedia.org/wikipedia/commons/f/f3/Stogra.png">Wikipedia</a>)</figcaption>  
</figure>

<p>While batch gradient descent converges to the minimum of the basin 
the parameters are placed in, SGD's fluctuation, on the one hand, 
enables it to jump to new and potentially better local minima. On the 
other hand, this ultimately complicates convergence to the exact 
minimum, as SGD will keep overshooting. However, it has been shown that 
when we slowly decrease the learning rate, SGD shows the same 
convergence behaviour as batch gradient descent, almost certainly 
converging to a local or the global minimum for non-convex and convex 
optimization respectively. <br>
Its code fragment simply adds a loop over the training examples and 
evaluates the gradient w.r.t. each example. Note that we shuffle the 
training data at every epoch as explained in <a href="http://ruder.io/optimizing-gradient-descent/index.html#shufflingandcurriculumlearning">this section</a>.</p>

<pre class=" language-python"><code class=" language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>nb_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
  np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token keyword">for</span> example <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    params_grad <span class="token operator">=</span> evaluate_gradient<span class="token punctuation">(</span>loss_function<span class="token punctuation">,</span> example<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
    params <span class="token operator">=</span> params <span class="token operator">-</span> learning_rate <span class="token operator">*</span> params_grad</code></pre>

<h2 id="minibatchgradientdescent">Mini-batch gradient descent</h2>

<p>Mini-batch gradient descent finally takes the best of both worlds and performs an update for every mini-batch of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-95" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.56em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.714em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">n</script> training examples:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 18.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.471em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.222em, 1014.38em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-106" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.856em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.52em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.572em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mo" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-121" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-125" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.832em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.548em;"><span class="texatom" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mo" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.611em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>;</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">\theta = \theta - \eta \cdot \nabla_\theta J( \theta; x^{(i:i+n)}; y^{(i:i+n)})</script>.</p>

<p>This way, it <em>a)</em> reduces the variance of the parameter updates, which can lead to more stable convergence; and <em>b)</em>
 can make use of highly optimized matrix optimizations common to 
state-of-the-art deep learning libraries that make computing the 
gradient w.r.t. a mini-batch very efficient. Common mini-batch sizes 
range between 50 and 256, but can vary for different applications. 
Mini-batch gradient descent is typically the algorithm of choice when 
training a neural network and the term SGD usually is employed also when
 mini-batches are used. Note: In modifications of SGD in the rest of 
this post, we leave out the parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 8.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.154em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.222em, 1006.15em, 2.609em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 2.856em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.52em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.572em;"><span class="texatom" id="MathJax-Span-141"><span class="mrow" id="MathJax-Span-142"><span class="mo" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-151" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.832em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.548em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mo" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 1.553em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>:</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-12">x^{(i:i+n)}; y^{(i:i+n)}</script> for simplicity.</p>

<p>In code, instead of iterating over examples, we now iterate over mini-batches of size 50:</p>

<pre class=" language-python"><code class=" language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>nb_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
  np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token keyword">for</span> batch <span class="token keyword">in</span> get_batches<span class="token punctuation">(</span>data<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    params_grad <span class="token operator">=</span> evaluate_gradient<span class="token punctuation">(</span>loss_function<span class="token punctuation">,</span> batch<span class="token punctuation">,</span> params<span class="token punctuation">)</span>
    params <span class="token operator">=</span> params <span class="token operator">-</span> learning_rate <span class="token operator">*</span> params_grad</code></pre>

<h1 id="challenges">Challenges</h1>

<p>Vanilla mini-batch gradient descent, however, does not guarantee good
 convergence, but offers a few challenges that need to be addressed:</p>

<ul>
<li><p>Choosing a proper learning rate can be difficult. A learning rate
 that is too small leads to painfully slow convergence, while a learning
 rate that is too large can hinder convergence and cause the loss 
function to fluctuate around the minimum or even to diverge.</p></li>
<li><p>Learning rate schedules [<sup id="fnref:11"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:11" rel="footnote">11</a></sup>]
 try to adjust the learning rate during training by e.g. annealing, i.e.
 reducing the learning rate according to a pre-defined schedule or when 
the change in objective between epochs falls below a threshold. These 
schedules and thresholds, however, have to be defined in advance and are
 thus unable to adapt to a dataset's characteristics [<sup id="fnref:10"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:10" rel="footnote">10</a></sup>].</p></li>
<li><p>Additionally, the same learning rate applies to all parameter 
updates. If our data is sparse and our features have very different 
frequencies, we might not want to update all of them to the same extent,
 but perform a larger update for rarely occurring features.</p></li>
<li><p>Another key challenge of minimizing highly non-convex error 
functions common for neural networks is avoiding getting trapped in 
their numerous suboptimal local minima. Dauphin et al. [<sup id="fnref:19"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:19" rel="footnote">19</a></sup>]
 argue that the difficulty arises in fact not from local minima but from
 saddle points, i.e. points where one dimension slopes up and another 
slopes down. These saddle points are usually surrounded by a plateau of 
the same error, which makes it notoriously hard for SGD to escape, as 
the gradient is close to zero in all dimensions.</p></li>
</ul>

<h1 id="gradientdescentoptimizationalgorithms">Gradient descent optimization algorithms</h1>

<p>In the following, we will outline some algorithms that are widely 
used by the deep learning community to deal with the aforementioned 
challenges. We will not discuss algorithms that are infeasible to 
compute in practice for high-dimensional data sets, e.g. second-order 
methods such as <a href="https://en.wikipedia.org/wiki/Newton%27s_method_in_optimization">Newton's method</a>.</p>

<h2 id="momentum">Momentum</h2>

<p>SGD has trouble navigating ravines, i.e. areas where the surface curves much more steeply in one dimension than in another [<sup id="fnref:1"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:1" rel="footnote">1</a></sup>],
 which are common around local optima. In these scenarios, SGD 
oscillates across the slopes of the ravine while only making hesitant 
progress along the bottom towards the local optimum as in Image 2.</p>

<table>  
  <tbody><tr>
    <td style="padding:1px">
      <figure>
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/without_momentum.gif" style="width: 90%; height: 90%" title="SGD without momentum">
<figcaption>Image 2: SGD without momentum</figcaption>  
</figure>  
    </td>
    <td style="padding:1px">
      <figure>
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/with_momentum.gif" style="width: 90%; height: 90%" title="SGD with momentum">
<figcaption>Image 3: SGD with momentum</figcaption>  
</figure>  
    </td>
  </tr>
</tbody></table>

<p>Momentum [<sup id="fnref:2"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:2" rel="footnote">2</a></sup>]
 is a method that helps accelerate SGD in the relevant direction and 
dampens oscillations as can be seen in Image 3. It does this by adding a
 fraction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-162" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\gamma</script> of the update vector of the past time step to the current update vector:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 12.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.904em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.642em, 1009.48em, 3.281em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mtable" id="MathJax-Span-167" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 9.59em; height: 0px;"><span style="position: absolute; clip: rect(2.421em, 1009.33em, 5.06em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.59em; height: 0px;"><span style="position: absolute; clip: rect(2.421em, 1009.33em, 5.06em, -1000em); top: -3.99em; right: 0em;"><span class="mtd" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mtable" id="MathJax-Span-170" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 9.256em; height: 0px;"><span style="position: absolute; clip: rect(2.778em, 1000.82em, 4.87em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.82em, 4.292em, -1000em); top: -4.615em; right: 0em;"><span class="mtd" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.265em; right: 0em;"><span class="mtd" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.471em, 1008.35em, 5.017em, -1000em); top: -3.99em; left: 0.815em;"><span style="display: inline-block; position: relative; width: 8.441em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1008.35em, 4.385em, -1000em); top: -4.615em; left: 0em;"><span class="mtd" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178"></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1003.84em, 4.292em, -1000em); top: -3.265em; left: 0em;"><span class="mtd" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202"></span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-206" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.265em; border-left: 0px solid; width: 0px; height: 3.18em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>v</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>θ</mi></mtd><mtd><mi></mi><mo>=</mo><mi>θ</mi><mo>−</mo><msub><mi>v</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-14">
\begin{align}
\begin{split}
v_t &= \gamma v_{t-1} + \eta \nabla_\theta J( \theta) \\  
\theta &= \theta - v_t
\end{split}
\end{align}
</script></p>

<p>Note: Some implementations exchange the signs in the equations. The momentum term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-209" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\gamma</script> is usually set to 0.9 or a similar value.</p>

<p>Essentially, when using momentum, we push a ball down a hill. The 
ball accumulates momentum as it rolls downhill, becoming faster and 
faster on the way (until it reaches its terminal velocity if there is 
air resistance, i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" style="width: 3.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.356em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.401em, 1002.28em, 2.572em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mn" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 1.272em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">\gamma < 1</script>).
 The same thing happens to our parameter updates: The momentum term 
increases for dimensions whose gradients point in the same directions 
and reduces updates for dimensions whose gradients change directions. As
 a result, we gain faster convergence and reduced oscillation.</p>

<h1 id="nesterovacceleratedgradient">Nesterov accelerated gradient</h1>

<p>However, a ball that rolls down a hill, blindly following the slope, 
is highly unsatisfactory. We'd like to have a smarter ball, a ball that 
has a notion of where it is going so that it knows to slow down before 
the hill slopes up again.</p>

<p>Nesterov accelerated gradient (NAG) [<sup id="fnref:7"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:7" rel="footnote">7</a></sup>] is a way to give our momentum term this kind of prescience. We know that we will use our momentum term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 2.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.26em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.384em, 1002.26em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.982em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">\gamma v_{t-1}</script> to move the parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-227" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.122em, 1000.47em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">\theta</script>. Computing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" style="width: 5.195em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.99em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.362em, 1003.99em, 2.572em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-237"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 1.322em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>−</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-19"> \theta - \gamma v_{t-1} </script>
 thus gives us an approximation of the next position of the parameters 
(the gradient is missing for the full update), a rough idea where our 
parameters are going to be. We can now effectively look ahead by 
calculating the gradient not w.r.t. to our current parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-242" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.122em, 1000.47em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">\theta</script> but w.r.t. the approximate future position of our parameters:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-245" style="width: 17.454em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.413em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.642em, 1012.98em, 3.281em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="mtable" id="MathJax-Span-247" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 13.074em; height: 0px;"><span style="position: absolute; clip: rect(2.421em, 1012.81em, 5.06em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.074em; height: 0px;"><span style="position: absolute; clip: rect(2.421em, 1012.81em, 5.06em, -1000em); top: -3.99em; right: 0em;"><span class="mtd" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mtable" id="MathJax-Span-250" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.74em; height: 0px;"><span style="position: absolute; clip: rect(2.778em, 1000.82em, 4.87em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.82em, 4.292em, -1000em); top: -4.615em; right: 0em;"><span class="mtd" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="msubsup" id="MathJax-Span-253"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.265em; right: 0em;"><span class="mtd" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.471em, 1011.83em, 5.017em, -1000em); top: -3.99em; left: 0.815em;"><span style="display: inline-block; position: relative; width: 11.925em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1011.83em, 4.385em, -1000em); top: -4.615em; left: 0em;"><span class="mtd" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258"></span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-261"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-270"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1003.84em, 4.292em, -1000em); top: -3.265em; left: 0em;"><span class="mtd" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mi" id="MathJax-Span-291"></span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-295" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.265em; border-left: 0px solid; width: 0px; height: 3.18em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>v</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>−</mo><mi>γ</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>θ</mi></mtd><mtd><mi></mi><mo>=</mo><mi>θ</mi><mo>−</mo><msub><mi>v</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-21">
\begin{align}
\begin{split}
v_t &= \gamma v_{t-1} + \eta \nabla_\theta J( \theta - \gamma v_{t-1} ) \\  
\theta &= \theta - v_t
\end{split}
\end{align}
</script></p>

<p>Again, we set the momentum term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">\gamma</script>
 to a value of around 0.9. While Momentum first computes the current 
gradient (small blue vector in Image 4) and then takes a big jump in the
 direction of the updated accumulated gradient (big blue vector), NAG 
first makes a big jump in the direction of the previous accumulated 
gradient (brown vector), measures the gradient and then makes a 
correction (red vector), which results in the complete NAG update (green
 vector). This anticipatory update prevents us from going too fast and 
results in increased responsiveness, which has significantly increased 
the performance of RNNs on a number of tasks [<sup id="fnref:8"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:8" rel="footnote">8</a></sup>].</p>

<figure>  
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/nesterov_update_vector.png" style="width: 50%; height: 50%" title="SGD fluctuation">
<figcaption>Image 4: Nesterov update (Source: <a href="http://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">G. Hinton's lecture 6c</a>)</figcaption>  
</figure>

<p>Refer to <a href="http://cs231n.github.io/neural-networks-3/">here</a>
 for another explanation about the intuitions behind NAG, while Ilya 
Sutskever gives a more detailed overview in his PhD thesis [<sup id="fnref:9"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:9" rel="footnote">9</a></sup>].</p>

<p>Now that we are able to adapt our updates to the slope of our error 
function and speed up SGD in turn, we would also like to adapt our 
updates to each individual parameter to perform larger or smaller 
updates depending on their importance.</p>

<h2 id="adagrad">Adagrad</h2>

<p>Adagrad [<sup id="fnref:3"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:3" rel="footnote">3</a></sup>]
 is an algorithm for gradient-based optimization that does just this: It
 adapts the learning rate to the parameters, performing larger updates 
for infrequent and smaller updates for frequent parameters. For this 
reason, it is well-suited for dealing with sparse data. Dean et al. [<sup id="fnref:4"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:4" rel="footnote">4</a></sup>]
 have found that Adagrad greatly improved the robustness of SGD and used
 it for training large-scale neural nets at Google, which -- among other
 things -- learned to <a href="http://www.wired.com/2012/06/google-x-neural-network/">recognize cats in Youtube videos</a>. Moreover, Pennington et al. [<sup id="fnref:5"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:5" rel="footnote">5</a></sup>] used Adagrad to train GloVe word embeddings, as infrequent words require much larger updates than frequent ones.</p>

<p>Previously, we performed an update for all parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.122em, 1000.47em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\theta</script> at once as every parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-304" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-305"><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">\theta_i</script> used the same learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">\eta</script>. As Adagrad uses a different learning rate for every parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-312" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">\theta_i</script> at every time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-317" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">t</script>, we first show Adagrad's per-parameter update, which we then vectorize. For brevity, we set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-320" style="width: 1.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.25em, 1.441em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-321"><span class="msubsup" id="MathJax-Span-322"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.436em; border-left: 0px solid; width: 0px; height: 1.073em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">g_{t, i}</script> to be the gradient of the objective function w.r.t. to the parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-329" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-330"><span class="msubsup" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">\theta_i</script> at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-334" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">t</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 8.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.49em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.365em, 1006.4em, 2.691em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-341"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-347" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.436em; border-left: 0px solid; width: 0px; height: 1.473em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">g_{t, i} = \nabla_\theta J( \theta_{t, i} )</script>.</p>

<p>The SGD update for every parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="msubsup" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">\theta_i</script> at each time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">t</script> then becomes:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-368" style="width: 10.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.365em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.41em, 1008.37em, 2.691em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-369"><span class="msubsup" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 2.143em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-372"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-377" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-378" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-380" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-390" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.436em; border-left: 0px solid; width: 0px; height: 1.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">\theta_{t+1, i} = \theta_{t, i} - \eta \cdot g_{t, i}</script>.</p>

<p>In its update rule, Adagrad modifies the general learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-397" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">\eta</script> at each time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-400" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">t</script> for every parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-403" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-404"><span class="msubsup" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">\theta_i</script> based on the past gradients that have been computed for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-409"><span class="msubsup" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">\theta_i</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 16.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.74em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1012.74em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="msubsup" id="MathJax-Span-415"><span style="display: inline-block; position: relative; width: 2.143em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-417"><span class="mrow" id="MathJax-Span-418"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-425" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.24em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-427"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-433" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-434"><span class="mfrac" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 4.574em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.022em, 1004.45em, 4.511em, -1000em); top: -3.206em; left: 50%; margin-left: -2.227em;"><span class="msqrt" id="MathJax-Span-437"><span style="display: inline-block; position: relative; width: 4.454em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1003.41em, 4.422em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-438"><span class="msubsup" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 1.801em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1003.45em, 3.907em, -1000em); top: -4.541em; left: 1em;"><span style="display: inline-block; position: relative; width: 3.454em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 2.76em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.369em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.847em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.325em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.803em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 2.282em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -3.964em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1004.57em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.574em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-450" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.087em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi><mi>i</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></msqrt></mfrac></mstyle><mo>⋅</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-39">\theta_{t+1, i} = \theta_{t, i} - \dfrac{\eta}{\sqrt{G_{t, ii} + \epsilon}} \cdot g_{t, i}</script>.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-457" style="width: 5.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.423em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.215em, 1004.42em, 2.562em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-458"><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-465" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.087em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.71em, 4.136em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.4em; left: 0.722em;"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.501em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mo>×</mo><mi>d</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-40">G_{t} \in \mathbb{R}^{d \times d} </script> here is a diagonal matrix where each diagonal element <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.406em, 1001.06em, 2.55em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.237em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>,</mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">i, i</script> is the sum of the squares of the gradients w.r.t. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-479" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.77em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-480"><span class="msubsup" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">\theta_i</script> up to time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-484" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-485"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">t</script> [<sup id="fnref:25"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:25" rel="footnote">25</a></sup>], while <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-487" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.396em, 1000.36em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.7em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">\epsilon</script> is a smoothing term that avoids division by zero (usually on the order of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-490" style="width: 3.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.644em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.401em, 1002.6em, 2.438em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="mn" id="MathJax-Span-492" style="font-family: MathJax_Main;">1</span><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-495" style="font-family: MathJax_Main; padding-left: 0.222em;">8</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.169em; border-left: 0px solid; width: 0px; height: 1.097em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mi>e</mi><mo>−</mo><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-45">1e-8</script>). Interestingly, without the square root operation, the algorithm performs much worse.</p>

<p>As <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-496" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.11em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-497"><span class="msubsup" id="MathJax-Span-498"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-500"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">G_{t}</script> contains the sum of the squares of the past gradients w.r.t. to all parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.122em, 1000.47em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.054em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">\theta</script> along its diagonal, we can now vectorize our implementation by performing a matrix-vector product <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-506" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.484em, 1000.71em, 2.439em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-507"><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">⊙</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.17em; border-left: 0px solid; width: 0px; height: 0.991em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊙</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">\odot</script> between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-509" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.11em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-510"><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">G_{t}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-516" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.82em, 1.359em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-517"><span class="msubsup" id="MathJax-Span-518"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">g_{t}</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 14.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1011.2em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="msubsup" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-533" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-539" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-540"><span class="mfrac" id="MathJax-Span-541"><span style="display: inline-block; position: relative; width: 3.889em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.958em, 1003.77em, 4.446em, -1000em); top: -3.142em; left: 50%; margin-left: -1.885em;"><span class="msqrt" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 3.769em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1002.72em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-544"><span class="msubsup" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-547"><span class="mrow" id="MathJax-Span-548"><span class="mi" id="MathJax-Span-549" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1002.77em, 3.907em, -1000em); top: -4.606em; left: 1em;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 2.075em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.437em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.983em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.529em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.029em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.89em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.889em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main; padding-left: 0.222em;">⊙</span><span class="msubsup" id="MathJax-Span-553" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-555"><span class="mrow" id="MathJax-Span-556"><span class="mi" id="MathJax-Span-557" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.087em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></msqrt></mfrac></mstyle><mo>⊙</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{\sqrt{G_{t} + \epsilon}} \odot g_{t}</script>.</p>

<p>One of Adagrad's main benefits is that it eliminates the need to 
manually tune the learning rate. Most implementations use a default 
value of 0.01 and leave it at that.</p>

<p>Adagrad's main weakness is its accumulation of the squared gradients 
in the denominator: Since every added term is positive, the accumulated 
sum keeps growing during training. This in turn causes the learning rate
 to shrink and eventually become infinitesimally small, at which point 
the algorithm is no longer able to acquire additional knowledge. The 
following algorithms aim to resolve this flaw.</p>

<h2 id="adadelta">Adadelta</h2>

<p>Adadelta [<sup id="fnref:6"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:6" rel="footnote">6</a></sup>]
 is an extension of Adagrad that seeks to reduce its aggressive, 
monotonically decreasing learning rate. Instead of accumulating all past
 squared gradients, Adadelta restricts the window of accumulated past 
gradients to some fixed size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-558" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.384em, 1000.7em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-559"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.715em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">w</script>.</p>

<p>Instead of inefficiently storing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-561" style="width: 0.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.384em, 1000.7em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.715em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">w</script>
 previous squared gradients, the sum of gradients is recursively defined
 as a decaying average of all past squared gradients. The running 
average <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-564" style="width: 3.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.596em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.233em, 1002.6em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.531em;"><span class="mn" id="MathJax-Span-570" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.534em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">E[g^2]_t</script> at time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-574" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.201em, 1000.35em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">t</script> then depends (as a fraction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-577" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-578"><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">\gamma </script> similarly to the Momentum term) only on the previous average and the current gradient:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-580" style="width: 17.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.173em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.233em, 1013.17em, 2.642em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-581"><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.531em;"><span class="mn" id="MathJax-Span-586" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-594"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.531em;"><span class="mn" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-597"><span style="display: inline-block; position: relative; width: 1.512em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-599"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-603" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-606" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-607" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-610"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.531em;"><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.477em;"><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.581em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub><mo>=</mo><mi>γ</mi><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-57">E[g^2]_t = \gamma E[g^2]_{t-1} + (1 - \gamma) g^2_t </script>.</p>

<p>We set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">\gamma</script>
 to a similar value as the momentum term, around 0.9. For clarity, we 
now rewrite our vanilla SGD update in terms of the parameter update 
vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 2.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.635em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.351em, 1001.64em, 2.514em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-620"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.261em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-59"> \Delta \theta_t </script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-623" style="width: 9.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.356em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.62em, 1007.02em, 3.303em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-624"><span class="mtable" id="MathJax-Span-625" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 7.024em; height: 0px;"><span style="position: absolute; clip: rect(2.399em, 1006.86em, 5.082em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.024em; height: 0px;"><span style="position: absolute; clip: rect(2.399em, 1006.86em, 5.082em, -1000em); top: -3.99em; right: 0em;"><span class="mtd" id="MathJax-Span-626"><span class="mrow" id="MathJax-Span-627"><span class="mtable" id="MathJax-Span-628" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 6.69em; height: 0px;"><span style="position: absolute; clip: rect(2.483em, 1001.7em, 5.082em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.13em, 1001.63em, 4.292em, -1000em); top: -4.638em; right: 0em;"><span class="mtd" id="MathJax-Span-629"><span class="mrow" id="MathJax-Span-630"><span class="mi" id="MathJax-Span-631" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-632"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -3.251em; right: 0em;"><span class="mtd" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-657" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.616em, 1004.99em, 5.032em, -1000em); top: -3.99em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 4.988em; height: 0px;"><span style="position: absolute; clip: rect(3.263em, 1004.59em, 4.422em, -1000em); top: -4.638em; left: 0em;"><span class="mtd" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mi" id="MathJax-Span-637"></span><span class="mo" id="MathJax-Span-638" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-642" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-647" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-648" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.13em, 1004.99em, 4.292em, -1000em); top: -3.251em; left: 0em;"><span class="mtd" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660"></span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-662" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Main; padding-left: 0.222em;">Δ</span><span class="msubsup" id="MathJax-Span-667"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.294em; border-left: 0px solid; width: 0px; height: 3.239em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mi>η</mi><mo>⋅</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-60">
\begin{align}
\begin{split}
\Delta \theta_t &= - \eta \cdot g_{t, i} \\
\theta_{t+1} &= \theta_t + \Delta \theta_t \end{split}
\end{align}
</script></p>

<p>The parameter update vector of Adagrad that we derived previously thus takes the form:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-670" style="width: 12.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.856em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1009.86em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-671"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-677" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mstyle" id="MathJax-Span-678"><span class="mrow" id="MathJax-Span-679"><span class="mfrac" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 3.889em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.958em, 1003.77em, 4.446em, -1000em); top: -3.142em; left: 50%; margin-left: -1.885em;"><span class="msqrt" id="MathJax-Span-682"><span style="display: inline-block; position: relative; width: 3.769em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1002.72em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-683"><span class="msubsup" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-686"><span class="mrow" id="MathJax-Span-687"><span class="mi" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1002.77em, 3.907em, -1000em); top: -4.606em; left: 1em;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 2.075em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.437em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.983em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.529em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.029em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.89em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.889em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.222em;">⊙</span><span class="msubsup" id="MathJax-Span-692" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-693" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.087em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>+</mo><mi>ϵ</mi></msqrt></mfrac></mstyle><mo>⊙</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-61"> \Delta \theta_t = - \dfrac{\eta}{\sqrt{G_{t} + \epsilon}} \odot g_{t}</script>.</p>

<p>We now simply replace the diagonal matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" style="width: 1.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.106em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.11em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-698"><span class="msubsup" id="MathJax-Span-699"><span style="display: inline-block; position: relative; width: 1.116em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.786em;"><span class="texatom" id="MathJax-Span-701"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">G_{t}</script> with the decaying average over past squared gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-704" style="width: 3.416em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.596em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.233em, 1002.6em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-708"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.531em;"><span class="mn" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-711"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-713" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.534em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-63">E[g^2]_t</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-714" style="width: 13.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.144em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.949em, 1010.14em, 3.516em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-715"><span class="mi" id="MathJax-Span-716" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-717"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-718" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-721" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mstyle" id="MathJax-Span-722"><span class="mrow" id="MathJax-Span-723"><span class="mfrac" id="MathJax-Span-724"><span style="display: inline-block; position: relative; width: 5.383em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-725" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.976em, 1005.26em, 4.465em, -1000em); top: -3.16em; left: 50%; margin-left: -2.631em;"><span class="msqrt" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 5.263em; height: 0px;"><span style="position: absolute; clip: rect(3.086em, 1004.21em, 4.385em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-727"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-730"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.279em; left: 0.531em;"><span class="mn" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-733"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-735" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-736" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1004.26em, 3.907em, -1000em); top: -4.587em; left: 1em;"><span style="display: inline-block; position: relative; width: 4.263em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 3.569em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.416em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.942em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.467em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.993em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 2.518em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 3.043em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.01em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1005.38em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.383em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.087em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub><mo>+</mo><mi>ϵ</mi></msqrt></mfrac></mstyle><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-64"> \Delta \theta_t = - \dfrac{\eta}{\sqrt{E[g^2]_t + \epsilon}} g_{t}</script>.</p>

<p>As the denominator is just the root mean squared (RMS) error 
criterion of the gradient, we can replace it with the criterion 
short-hand:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-743" style="width: 11.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.702em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.949em, 1008.7em, 3.316em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-746"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-748" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mstyle" id="MathJax-Span-751"><span class="mrow" id="MathJax-Span-752"><span class="mfrac" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 3.941em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1003.82em, 4.385em, -1000em); top: -3.28em; left: 50%; margin-left: -1.911em;"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-761"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-762" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.94em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.941em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-767" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-768" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.311em; border-left: 0px solid; width: 0px; height: 2.827em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi>g</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac></mstyle><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-65"> \Delta \theta_t = - \dfrac{\eta}{RMS[g]_{t}} g_t</script>.</p>

<p>The authors note that the units in this update (as well as in SGD, 
Momentum, or Adagrad) do not match, i.e. the update should have the same
 hypothetical units as the parameter. To realize this, they first define
 another exponentially decaying average, this time not of squared 
gradients but of squared parameter updates:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-769" style="width: 20.099em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.433em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.233em, 1015.43em, 2.642em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.469em;"><span class="mn" id="MathJax-Span-776" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-777"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-781" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-783" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.353em; left: 0.469em;"><span class="mn" id="MathJax-Span-787" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 1.512em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-790"><span class="mrow" id="MathJax-Span-791"><span class="mi" id="MathJax-Span-792" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-793" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-794" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-797" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-798" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-802"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.469em;"><span class="mn" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.469em;"><span class="mi" id="MathJax-Span-805" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.581em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub><mo>=</mo><mi>γ</mi><mi>E</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>θ</mi><mi>t</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-66">E[\Delta \theta^2]_t = \gamma E[\Delta \theta^2]_{t-1} + (1 - \gamma) \Delta \theta^2_t </script>.</p>

<p>The root mean squared error of parameter updates is thus: </p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-806" style="width: 15.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.019em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.246em, 1012.02em, 2.734em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-807"><span class="mi" id="MathJax-Span-808" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-814"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-819" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msqrt" id="MathJax-Span-820" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 6.034em; height: 0px;"><span style="position: absolute; clip: rect(3.086em, 1004.99em, 4.385em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-821"><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-825"><span style="display: inline-block; position: relative; width: 0.898em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-826" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.279em; left: 0.469em;"><span class="mn" id="MathJax-Span-827" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-828"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-830" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1005.03em, 3.907em, -1000em); top: -4.587em; left: 1em;"><span style="display: inline-block; position: relative; width: 5.034em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 4.34em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.447em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.003em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.559em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 2.115em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 2.672em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 3.228em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 3.784em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.01em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.492em; border-left: 0px solid; width: 0px; height: 1.685em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><msqrt><mi>E</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><msup><mi>θ</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub><mo>+</mo><mi>ϵ</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-67">RMS[\Delta \theta]_{t} = \sqrt{E[\Delta \theta^2]_t + \epsilon} </script>.</p>

<p>Since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-833" style="width: 6.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.663em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.317em, 1004.66em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-840" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-842" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-843"><span class="mrow" id="MathJax-Span-844"><span class="mi" id="MathJax-Span-845" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-68">RMS[\Delta \theta]_{t}</script> is unknown, we approximate it with the RMS of parameter updates until the previous time step. Replacing the learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-846" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">\eta </script> in the previous update rule with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-849" style="width: 7.262em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.317em, 1005.58em, 2.606em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-850"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-854" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-856" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-857"><span style="display: inline-block; position: relative; width: 1.512em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-858" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-70">RMS[\Delta \theta]_{t-1}</script> finally yields the Adadelta update rule:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-864" style="width: 14.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.047em, 1010.87em, 3.97em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-865"><span class="mtable" id="MathJax-Span-866" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.863em; height: 0px;"><span style="position: absolute; clip: rect(2.453em, 1010.7em, 6.47em, -1000em); top: -4.712em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.863em; height: 0px;"><span style="position: absolute; clip: rect(2.453em, 1010.7em, 6.47em, -1000em); top: -4.712em; right: 0em;"><span class="mtd" id="MathJax-Span-867"><span class="mrow" id="MathJax-Span-868"><span class="mtable" id="MathJax-Span-869" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.529em; height: 0px;"><span style="position: absolute; clip: rect(2.476em, 1001.7em, 5.749em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.13em, 1001.63em, 4.292em, -1000em); top: -4.644em; right: 0em;"><span class="mtd" id="MathJax-Span-870"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-873"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-874" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-875" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.584em; right: 0em;"><span class="mtd" id="MathJax-Span-914"><span class="mrow" id="MathJax-Span-915"><span class="msubsup" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-921" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.405em, 1008.83em, 6.372em, -1000em); top: -4.663em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 8.826em; height: 0px;"><span style="position: absolute; clip: rect(2.386em, 1008.83em, 5.095em, -1000em); top: -4.644em; left: 0em;"><span class="mtd" id="MathJax-Span-876"><span class="mrow" id="MathJax-Span-877"><span class="mi" id="MathJax-Span-878"></span><span class="mo" id="MathJax-Span-879" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-880" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mstyle" id="MathJax-Span-881"><span class="mrow" id="MathJax-Span-882"><span class="mfrac" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 5.667em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.096em, 1005.55em, 4.385em, -1000em); top: -4.701em; left: 50%; margin-left: -2.773em;"><span class="mrow" id="MathJax-Span-884"><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-886" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-891"><span style="display: inline-block; position: relative; width: 1.512em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-893"><span class="mrow" id="MathJax-Span-894"><span class="mi" id="MathJax-Span-895" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-896" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1003.82em, 4.385em, -1000em); top: -3.28em; left: 50%; margin-left: -1.911em;"><span class="mrow" id="MathJax-Span-898"><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-901" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-902" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-905" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-906"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1005.67em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.667em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-909"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-910" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-911"><span class="mrow" id="MathJax-Span-912"><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.13em, 1004.99em, 4.292em, -1000em); top: -2.584em; left: 0em;"><span class="mtd" id="MathJax-Span-923"><span class="mrow" id="MathJax-Span-924"><span class="mi" id="MathJax-Span-925"></span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-927" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-928" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Main; padding-left: 0.222em;">Δ</span><span class="msubsup" id="MathJax-Span-932"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-934" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.663em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.161em; border-left: 0px solid; width: 0px; height: 4.972em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi mathvariant="normal">Δ</mi><mi>θ</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi>g</mi><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mrow></mfrac></mstyle><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>θ</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-71">
\begin{align}
\begin{split}
\Delta \theta_t &= - \dfrac{RMS[\Delta \theta]_{t-1}}{RMS[g]_{t}} g_{t} \\
\theta_{t+1} &= \theta_t + \Delta \theta_t 
\end{split}
\end{align}
</script></p>

<p>With Adadelta, we do not even need to set a default learning rate, as it has been eliminated from the update rule.</p>

<h2 id="rmsprop">RMSprop</h2>

<p>RMSprop is an unpublished, adaptive learning rate method proposed by Geoff Hinton in <a href="http://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">Lecture 6e of his Coursera Class</a>.</p>

<p>RMSprop and Adadelta have both been developed independently around 
the same time stemming from the need to resolve Adagrad's radically 
diminishing learning rates. RMSprop in fact is identical to the first 
update vector of Adadelta that we derived above:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.9&lt;/mn&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-935" style="width: 17.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.077em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.057em, 1012.74em, 3.98em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-936"><span class="mtable" id="MathJax-Span-937" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.729em; height: 0px;"><span style="position: absolute; clip: rect(2.491em, 1012.56em, 6.528em, -1000em); top: -4.76em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.729em; height: 0px;"><span style="position: absolute; clip: rect(2.491em, 1012.56em, 6.528em, -1000em); top: -4.76em; right: 0em;"><span class="mtd" id="MathJax-Span-938"><span class="mrow" id="MathJax-Span-939"><span class="mtable" id="MathJax-Span-940" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.395em; height: 0px;"><span style="position: absolute; clip: rect(1.722em, 1002.61em, 4.807em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.61em; height: 0px;"><span style="position: absolute; clip: rect(2.962em, 1002.61em, 4.385em, -1000em); top: -5.231em; right: 0em;"><span class="mtd" id="MathJax-Span-941"><span class="mrow" id="MathJax-Span-942"><span class="mi" id="MathJax-Span-943" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-946" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.531em;"><span class="mn" id="MathJax-Span-947" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-948"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-950" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -3.526em; right: 0em;"><span class="mtd" id="MathJax-Span-974"><span class="mrow" id="MathJax-Span-975"><span class="msubsup" id="MathJax-Span-976"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-977" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-978"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-981" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-982" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.491em, 1009.79em, 6.528em, -1000em); top: -4.76em; left: 2.61em;"><span style="display: inline-block; position: relative; width: 9.785em; height: 0px;"><span style="position: absolute; clip: rect(2.962em, 1009.59em, 4.421em, -1000em); top: -5.231em; left: 0em;"><span class="mtd" id="MathJax-Span-951"><span class="mrow" id="MathJax-Span-952"><span class="mi" id="MathJax-Span-953"></span><span class="mo" id="MathJax-Span-954" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-955" style="font-family: MathJax_Main; padding-left: 0.278em;">0.9</span><span class="mi" id="MathJax-Span-956" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-957" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-958"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.531em;"><span class="mn" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-961"><span style="display: inline-block; position: relative; width: 1.512em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-962" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="texatom" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="mi" id="MathJax-Span-965" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-966" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-969" style="font-family: MathJax_Main; padding-left: 0.222em;">0.1</span><span class="msubsup" id="MathJax-Span-970"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.531em;"><span class="mn" id="MathJax-Span-972" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.477em;"><span class="mi" id="MathJax-Span-973" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1009.79em, 5.295em, -1000em); top: -3.526em; left: 0em;"><span class="mtd" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="mi" id="MathJax-Span-985"></span><span class="mo" id="MathJax-Span-986" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-987" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-989"><span class="mrow" id="MathJax-Span-990"><span class="mi" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-992" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-993" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-994"><span class="mfrac" id="MathJax-Span-995"><span style="display: inline-block; position: relative; width: 5.383em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-996" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.976em, 1005.26em, 4.465em, -1000em); top: -3.16em; left: 50%; margin-left: -2.631em;"><span class="msqrt" id="MathJax-Span-997"><span style="display: inline-block; position: relative; width: 5.263em; height: 0px;"><span style="position: absolute; clip: rect(3.086em, 1004.21em, 4.385em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-998"><span class="mi" id="MathJax-Span-999" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-1000" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.279em; left: 0.531em;"><span class="mn" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1004"><span style="display: inline-block; position: relative; width: 0.608em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main;">]</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.278em;"><span class="mi" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1007" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1004.26em, 3.907em, -1000em); top: -4.587em; left: 1em;"><span style="display: inline-block; position: relative; width: 4.263em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 3.569em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.416em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 0.942em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.467em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 1.993em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 2.518em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.99em; left: 3.043em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.01em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1005.38em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.383em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1009"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-1011"><span class="mrow" id="MathJax-Span-1012"><span class="mi" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.76em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.76em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.76em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.174em; border-left: 0px solid; width: 0px; height: 4.998em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mn>0.9</mn><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>0.1</mn><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><mi>E</mi><mo stretchy="false">[</mo><msup><mi>g</mi><mn>2</mn></msup><msub><mo stretchy="false">]</mo><mi>t</mi></msub><mo>+</mo><mi>ϵ</mi></msqrt></mfrac></mstyle><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-72">
\begin{align}
\begin{split}
E[g^2]_t &= 0.9 E[g^2]_{t-1} + 0.1 g^2_t \\  
\theta_{t+1} &= \theta_{t} - \dfrac{\eta}{\sqrt{E[g^2]_t + \epsilon}} g_{t}
\end{split}
\end{align}
</script></p>

<p>RMSprop as well divides the learning rate by an exponentially decaying average of squared gradients. Hinton suggests <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1014" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1015"><span class="mi" id="MathJax-Span-1016" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">\gamma</script> to be set to 0.9, while a good default value for the learning rate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1017" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1018"><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">\eta</script> is 0.001.</p>

<h2 id="adam">Adam</h2>

<p>Adaptive Moment Estimation (Adam) [<sup id="fnref:15"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:15" rel="footnote">15</a></sup>]
 is another method that computes adaptive learning rates for each 
parameter. In addition to storing an exponentially decaying average of 
past squared gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1020" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1021"><span class="msubsup" id="MathJax-Span-1022"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">v_t</script> like Adadelta and RMSprop, Adam also keeps an exponentially decaying average of past gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1025" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1026"><span class="msubsup" id="MathJax-Span-1027"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1028" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1029" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">m_t</script>, similar to momentum:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1030" style="width: 15.387em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.827em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.592em, 1011.49em, 3.331em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1031"><span class="mtable" id="MathJax-Span-1032" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.507em; height: 0px;"><span style="position: absolute; clip: rect(2.37em, 1011.34em, 5.11em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.507em; height: 0px;"><span style="position: absolute; clip: rect(2.37em, 1011.34em, 5.11em, -1000em); top: -3.99em; right: 0em;"><span class="mtd" id="MathJax-Span-1033"><span class="mrow" id="MathJax-Span-1034"><span class="mtable" id="MathJax-Span-1035" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.173em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1001.21em, 4.982em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -4.666em; right: 0em;"><span class="mtd" id="MathJax-Span-1036"><span class="mrow" id="MathJax-Span-1037"><span class="msubsup" id="MathJax-Span-1038"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.403em, 1000.82em, 4.292em, -1000em); top: -3.301em; right: 0em;"><span class="mtd" id="MathJax-Span-1066"><span class="mrow" id="MathJax-Span-1067"><span class="msubsup" id="MathJax-Span-1068"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1069" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.42em, 1009.96em, 5.11em, -1000em); top: -3.99em; left: 1.208em;"><span style="display: inline-block; position: relative; width: 9.964em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1009.96em, 4.385em, -1000em); top: -4.666em; left: 0em;"><span class="mtd" id="MathJax-Span-1041"><span class="mrow" id="MathJax-Span-1042"><span class="mi" id="MathJax-Span-1043"></span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1045" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1046" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1048"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1049" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1050"><span class="mrow" id="MathJax-Span-1051"><span class="mi" id="MathJax-Span-1052" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1054" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1055" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1056" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1057" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1058" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1059" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1061" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1062" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1063"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1065" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.031em, 1009.72em, 4.421em, -1000em); top: -3.301em; left: 0em;"><span class="mtd" id="MathJax-Span-1071"><span class="mrow" id="MathJax-Span-1072"><span class="mi" id="MathJax-Span-1073"></span><span class="mo" id="MathJax-Span-1074" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1075" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1076" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1077" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1078"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1079" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1080"><span class="mrow" id="MathJax-Span-1081"><span class="mi" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1083" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1085" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1086" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1087" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1088" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1089" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1093"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1094" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.531em;"><span class="mn" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.477em;"><span class="mi" id="MathJax-Span-1096" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.331em; border-left: 0px solid; width: 0px; height: 3.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-77">
\begin{align}
\begin{split}
m_t &= \beta_1 m_{t-1} + (1 - \beta_1) g_t \\  
v_t &= \beta_2 v_{t-1} + (1 - \beta_2) g_t^2  
\end{split}
\end{align}
</script></p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1097" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1098"><span class="msubsup" id="MathJax-Span-1099"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-78">m_t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1102" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1103"><span class="msubsup" id="MathJax-Span-1104"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1105" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-79">v_t</script>
 are estimates of the first moment (the mean) and the second moment (the
 uncentered variance) of the gradients respectively, hence the name of 
the method. As <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1107" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1108"><span class="msubsup" id="MathJax-Span-1109"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1110" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-80">m_t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1112" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1113"><span class="msubsup" id="MathJax-Span-1114"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1115" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-81">v_t</script>
 are initialized as vectors of 0's, the authors of Adam observe that 
they are biased towards zero, especially during the initial time steps, 
and especially when the decay rates are small (i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1117" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.01em, 1.348em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1118"><span class="msubsup" id="MathJax-Span-1119"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1120" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1121" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-82">\beta_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1122" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.01em, 1.348em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1123"><span class="msubsup" id="MathJax-Span-1124"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1125" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">\beta_2</script> are close to 1). </p>

<p>They counteract these biases by computing bias-corrected first and second moment estimates:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1127" style="width: 8.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.298em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.513em, 1005.96em, 4.436em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1128"><span class="mtable" id="MathJax-Span-1129" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 5.953em; height: 0px;"><span style="position: absolute; clip: rect(2.948em, 1005.79em, 7.898em, -1000em); top: -5.673em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.953em; height: 0px;"><span style="position: absolute; clip: rect(2.948em, 1005.79em, 7.898em, -1000em); top: -5.673em; right: 0em;"><span class="mtd" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mtable" id="MathJax-Span-1132" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 5.619em; height: 0px;"><span style="position: absolute; clip: rect(2.044em, 1001.21em, 5.696em, -1000em); top: -4.375em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1001.21em, 4.292em, -1000em); top: -5.452em; right: 0em;"><span class="mtd" id="MathJax-Span-1133"><span class="mrow" id="MathJax-Span-1134"><span class="msubsup" id="MathJax-Span-1135"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="munderover" id="MathJax-Span-1138"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1140" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1141" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -2.971em; right: 0em;"><span class="mtd" id="MathJax-Span-1159"><span class="mrow" id="MathJax-Span-1160"><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="munderover" id="MathJax-Span-1164"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-1165" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.375em;"></span></span><span style="position: absolute; clip: rect(2.948em, 1004.41em, 7.898em, -1000em); top: -5.673em; left: 1.208em;"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px;"><span style="position: absolute; clip: rect(2.728em, 1004.41em, 5.196em, -1000em); top: -5.452em; left: 0em;"><span class="mtd" id="MathJax-Span-1142"><span class="mrow" id="MathJax-Span-1143"><span class="mi" id="MathJax-Span-1144"></span><span class="mo" id="MathJax-Span-1145" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-1146" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1147"><span class="mfrac" id="MathJax-Span-1148"><span style="display: inline-block; position: relative; width: 2.837em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -4.667em; left: 50%; margin-left: -0.604em;"><span class="msubsup" id="MathJax-Span-1149"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1150" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-1152"><span class="mn" id="MathJax-Span-1153" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1154" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1155" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1156" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1002.84em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.837em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.727em, 1004.41em, 5.196em, -1000em); top: -2.971em; left: 0em;"><span class="mtd" id="MathJax-Span-1168"><span class="mrow" id="MathJax-Span-1169"><span class="mi" id="MathJax-Span-1170"></span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-1172" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1173"><span class="mfrac" id="MathJax-Span-1174"><span style="display: inline-block; position: relative; width: 2.837em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.403em, 1000.82em, 4.292em, -1000em); top: -4.667em; left: 50%; margin-left: -0.408em;"><span class="msubsup" id="MathJax-Span-1175"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1176" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1177" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-1178"><span class="mn" id="MathJax-Span-1179" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1181" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1002.84em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.837em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.673em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.673em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.673em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.767em; border-left: 0px solid; width: 0px; height: 6.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>m</mi><mi>t</mi></msub><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>v</mi><mi>t</mi></msub><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>2</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-84">
\begin{align}
\begin{split}
\hat{m}_t &= \dfrac{m_t}{1 - \beta^t_1} \\
\hat{v}_t &= \dfrac{v_t}{1 - \beta^t_2} \end{split}
\end{align}
</script></p>

<p>They then use these to update the parameters just as we have seen in Adadelta and RMSprop, which yields the Adam update rule:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1185" style="width: 13.272em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.192em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1010.19em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-1186"><span class="msubsup" id="MathJax-Span-1187"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mi" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1192" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1193" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1195" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1196" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1200" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-1201" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-1202"><span class="mfrac" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-1205"><span class="msqrt" id="MathJax-Span-1206"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-1207"><span class="msubsup" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1209"><span class="mrow" id="MathJax-Span-1210"><span class="munderover" id="MathJax-Span-1211"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1215" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1216" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1217"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1218"><span class="mrow" id="MathJax-Span-1219"><span class="munderover" id="MathJax-Span-1220"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1221" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.087em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac></mstyle><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-85">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{\sqrt{\hat{v}_t} + \epsilon} \hat{m}_t</script>.</p>

<p>The authors propose default values of 0.9 for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1224" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.01em, 1.348em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1225"><span class="msubsup" id="MathJax-Span-1226"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-86">\beta_1</script>, 0.999 for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1229" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.01em, 1.348em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1230"><span class="msubsup" id="MathJax-Span-1231"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1233" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-87">\beta_2</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1234" style="width: 2.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.971em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.001em, 1001.97em, 1.176em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1235"><span class="msubsup" id="MathJax-Span-1236"><span style="display: inline-block; position: relative; width: 1.979em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.96em, 4.157em, -1000em); top: -3.99em; left: 0em;"><span class="mn" id="MathJax-Span-1237" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.383em; left: 1em;"><span class="texatom" id="MathJax-Span-1238"><span class="mrow" id="MathJax-Span-1239"><span class="mo" id="MathJax-Span-1240" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1241" style="font-size: 70.7%; font-family: MathJax_Main;">8</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 1.277em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>8</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-88">10^{-8}</script> for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1242" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.385em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.396em, 1000.36em, 2.126em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1243"><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Math; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.7em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">\epsilon</script>. They show empirically that Adam works well in practice and compares favorably to other adaptive learning-method algorithms.</p>

<h2 id="adamax">AdaMax</h2>

<p>The <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1245" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1246"><span class="msubsup" id="MathJax-Span-1247"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1248" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1249" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-90">v_t</script> factor in the Adam update rule scales the gradient inversely proportionally to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1250" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.87em, 1.304em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1251"><span class="msubsup" id="MathJax-Span-1252"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mn" id="MathJax-Span-1254" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.258em; border-left: 0px solid; width: 0px; height: 1.236em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-91">\ell_2</script> norm of the past gradients (via the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1255" style="width: 2.262em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.731em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1001.73em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1256"><span class="msubsup" id="MathJax-Span-1257"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1259"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1262" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1263" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 0.971em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">v_{t-1}</script> term) and current gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1264" style="width: 2.31em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.779em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.119em, 1001.78em, 2.605em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1265"><span class="texatom" id="MathJax-Span-1266"><span class="mrow" id="MathJax-Span-1267"><span class="mo" id="MathJax-Span-1268" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1269"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1270" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1272"><span style="display: inline-block; position: relative; width: 0.707em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.384em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1273"><span class="mrow" id="MathJax-Span-1274"><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.278em;"><span class="mn" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.681em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>g</mi><mi>t</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-93">|g_t|^2</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1277" style="width: 14.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.346em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.167em, 1011.35em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-1278"><span class="msubsup" id="MathJax-Span-1279"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1282" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1283" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1284" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1286"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1288"><span class="mrow" id="MathJax-Span-1289"><span class="mi" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1295" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1296" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1297" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1299" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1300" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1301"><span class="mrow" id="MathJax-Span-1302"><span class="mo" id="MathJax-Span-1303" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1304"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1306" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1307"><span style="display: inline-block; position: relative; width: 0.707em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.384em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1308"><span class="mrow" id="MathJax-Span-1309"><span class="mo" id="MathJax-Span-1310" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.278em;"><span class="mn" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.682em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>g</mi><mi>t</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-94">v_t = \beta_2 v_{t-1} + (1 - \beta_2) |g_t|^2</script></p>

<p>We can generalize this update to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1312" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.87em, 1.441em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1313"><span class="msubsup" id="MathJax-Span-1314"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mi" id="MathJax-Span-1316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.436em; border-left: 0px solid; width: 0px; height: 1.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mi>p</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-95">\ell_p</script> norm. Note that Kingma and Ba also parameterize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1317" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.01em, 1.348em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1318"><span class="msubsup" id="MathJax-Span-1319"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1320" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-96">\beta_2</script> as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1322" style="width: 1.397em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.071em, 1001.06em, 1.46em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1323"><span class="msubsup" id="MathJax-Span-1324"><span style="display: inline-block; position: relative; width: 1.056em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1325" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.43em, 4.272em, -1000em); top: -4.472em; left: 0.625em;"><span class="mi" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.461em; border-left: 0px solid; width: 0px; height: 1.556em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>β</mi><mn>2</mn><mi>p</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-97">\beta^p_2</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1328" style="width: 14.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.442em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.321em, 1011.44em, 2.71em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-1329"><span class="msubsup" id="MathJax-Span-1330"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1332" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1333" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1334" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.056em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1335" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.43em, 4.272em, -1000em); top: -4.472em; left: 0.625em;"><span class="mi" id="MathJax-Span-1336" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1338"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1340"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1343" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1345" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1347" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1349" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.056em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.43em, 4.272em, -1000em); top: -4.472em; left: 0.625em;"><span class="mi" id="MathJax-Span-1351" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1352" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1354"><span class="mrow" id="MathJax-Span-1355"><span class="mo" id="MathJax-Span-1356" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1357"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1358" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1360"><span style="display: inline-block; position: relative; width: 0.709em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.384em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1361"><span class="mrow" id="MathJax-Span-1362"><span class="mo" id="MathJax-Span-1363" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.278em;"><span class="mi" id="MathJax-Span-1364" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.461em; border-left: 0px solid; width: 0px; height: 1.556em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi>β</mi><mn>2</mn><mi>p</mi></msubsup><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>2</mn><mi>p</mi></msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>g</mi><mi>t</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>p</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-98">v_t = \beta_2^p v_{t-1} + (1 - \beta_2^p) |g_t|^p</script></p>

<p>Norms for large <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1365" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.309em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1366"><span class="mi" id="MathJax-Span-1367" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 0.952em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">p</script> values generally become numerically unstable, which is why <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1368" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.87em, 1.304em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1369"><span class="msubsup" id="MathJax-Span-1370"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1371" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mn" id="MathJax-Span-1372" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.258em; border-left: 0px solid; width: 0px; height: 1.236em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">\ell_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1373" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1000.87em, 1.304em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1374"><span class="msubsup" id="MathJax-Span-1375"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1376" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mn" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.258em; border-left: 0px solid; width: 0px; height: 1.236em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-101">\ell_2</script> norms are most common in practice. However, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1378" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1379"><span class="msubsup" id="MathJax-Span-1380"><span style="display: inline-block; position: relative; width: 1.199em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1381" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mi" id="MathJax-Span-1382" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mi mathvariant="normal">∞</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-102">\ell_\infty</script> also generally exhibits stable behavior. For this reason, the authors propose AdaMax (Kingma and Ba, 2015) and show that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1383" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1384"><span class="msubsup" id="MathJax-Span-1385"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1386" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1387" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-103">v_t</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1388" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1389"><span class="msubsup" id="MathJax-Span-1390"><span style="display: inline-block; position: relative; width: 1.199em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.4em, 4.155em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1391" style="font-family: MathJax_Main;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.417em;"><span class="mi" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mi mathvariant="normal">∞</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-104">\ell_\infty</script> converges to the following more stable value. To avoid confusion with Adam, we use <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1393" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.91em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1394"><span class="msubsup" id="MathJax-Span-1395"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1396" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-105">u_t</script> to denote the infinity norm-constrained <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1398" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1399"><span class="msubsup" id="MathJax-Span-1400"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1401" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1402" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-106">v_t</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1403" style="width: 17.31em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.317em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.589em, 1012.98em, 3.334em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1404"><span class="mtable" id="MathJax-Span-1405" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.971em; height: 0px;"><span style="position: absolute; clip: rect(2.368em, 1012.8em, 5.113em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.971em; height: 0px;"><span style="position: absolute; clip: rect(2.368em, 1012.8em, 5.113em, -1000em); top: -3.99em; right: 0em;"><span class="mtd" id="MathJax-Span-1406"><span class="mrow" id="MathJax-Span-1407"><span class="mtable" id="MathJax-Span-1408" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.637em; height: 0px;"><span style="position: absolute; clip: rect(2.726em, 1000.9em, 4.863em, -1000em); top: -3.99em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.9em, 4.292em, -1000em); top: -4.669em; right: 0em;"><span class="mtd" id="MathJax-Span-1409"><span class="mrow" id="MathJax-Span-1410"><span class="msubsup" id="MathJax-Span-1411"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1412" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1413" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.846em, 1000em, 4.135em, -1000em); top: -3.262em; right: 0em;"><span class="mtd" id="MathJax-Span-1449"><span class="mrow" id="MathJax-Span-1450"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.378em, 1011.74em, 5.113em, -1000em); top: -3.99em; left: 0.902em;"><span style="display: inline-block; position: relative; width: 11.735em; height: 0px;"><span style="position: absolute; clip: rect(3.057em, 1011.74em, 4.441em, -1000em); top: -4.669em; left: 0em;"><span class="mtd" id="MathJax-Span-1414"><span class="mrow" id="MathJax-Span-1415"><span class="mi" id="MathJax-Span-1416"></span><span class="mo" id="MathJax-Span-1417" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1418" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.407em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.78em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1421" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1422"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1423" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1424"><span class="mrow" id="MathJax-Span-1425"><span class="mi" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1428" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1429" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1430" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1431" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1433" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.407em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.534em, 1000.78em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-1435" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1437" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1438"><span class="mrow" id="MathJax-Span-1439"><span class="mo" id="MathJax-Span-1440" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1441"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1442" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1444"><span style="display: inline-block; position: relative; width: 1.06em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.16em, 4.384em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1445"><span class="mrow" id="MathJax-Span-1446"><span class="mo" id="MathJax-Span-1447" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.467em; left: 0.278em;"><span class="mi" id="MathJax-Span-1448" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1009.12em, 4.385em, -1000em); top: -3.262em; left: 0em;"><span class="mtd" id="MathJax-Span-1451"><span class="mrow" id="MathJax-Span-1452"><span class="mi" id="MathJax-Span-1453"></span><span class="mo" id="MathJax-Span-1454" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main; padding-left: 0.278em;">max</span><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1457"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1459" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1460" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-1461" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1462" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-1463"><span class="mrow" id="MathJax-Span-1464"><span class="mi" id="MathJax-Span-1465" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1468" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-1469" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-1470"><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1472"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1473" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1474" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1475"><span class="mrow" id="MathJax-Span-1476"><span class="mo" id="MathJax-Span-1477" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1478" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.334em; border-left: 0px solid; width: 0px; height: 3.318em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>u</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msubsup><mi>β</mi><mn>2</mn><mi mathvariant="normal">∞</mi></msubsup><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>2</mn><mi mathvariant="normal">∞</mi></msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>g</mi><mi>t</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="normal">∞</mi></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>β</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>g</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-107">
\begin{align}
\begin{split}
u_t &= \beta_2^\infty v_{t-1} + (1 - \beta_2^\infty) |g_t|^\infty\\  
              & = \max(\beta_2 \cdot v_{t-1}, |g_t|)
\end{split}
\end{align}
</script></p>

<p>We can now plug this into the Adam update equation by replacing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1479" style="width: 4.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.558em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.168em, 1003.53em, 2.657em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1480"><span class="msqrt" id="MathJax-Span-1481"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-1482"><span class="msubsup" id="MathJax-Span-1483"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1484"><span class="mrow" id="MathJax-Span-1485"><span class="munderover" id="MathJax-Span-1486"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-1487" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-1488" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.454em; border-left: 0px solid; width: 0px; height: 1.685em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">\sqrt{\hat{v}_t} + \epsilon</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1492" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.91em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1493"><span class="msubsup" id="MathJax-Span-1494"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1495" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-109">u_t</script> to obtain the AdaMax update rule:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1497" style="width: 9.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.5em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1007.5em, 3.248em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-1498"><span class="msubsup" id="MathJax-Span-1499"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span class="mi" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1505" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1507" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1508" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1509"><span class="mrow" id="MathJax-Span-1510"><span class="mi" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1512" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-1513" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-1514"><span class="mfrac" id="MathJax-Span-1515"><span style="display: inline-block; position: relative; width: 1.022em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.9em, 4.292em, -1000em); top: -3.304em; left: 50%; margin-left: -0.451em;"><span class="msubsup" id="MathJax-Span-1517"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1518" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1001.02em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.022em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1520"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1521"><span class="mrow" id="MathJax-Span-1522"><span class="munderover" id="MathJax-Span-1523"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1524" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1525" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.159em; border-left: 0px solid; width: 0px; height: 2.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msub><mi>u</mi><mi>t</mi></msub></mfrac></mstyle><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-110">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{u_t} \hat{m}_t</script></p>

<p>Note that as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1527" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.91em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1528"><span class="msubsup" id="MathJax-Span-1529"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1530" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1531" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-111">u_t</script> relies on the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1532" style="width: 2.406em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.827em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.619em, 1001.82em, 2.367em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1533"><span class="mo" id="MathJax-Span-1534" style="font-family: MathJax_Main;">max</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.077em; border-left: 0px solid; width: 0px; height: 0.722em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo></math></span></span><script type="math/tex" id="MathJax-Element-112">\max</script> operation, it is not as suggestible to bias towards zero as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1535" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1536"><span class="msubsup" id="MathJax-Span-1537"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1538" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1539" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">m_t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1540" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1541"><span class="msubsup" id="MathJax-Span-1542"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1543" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-114">v_t</script> in Adam, which is why we do not need to compute a bias correction for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1545" style="width: 1.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.91em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1546"><span class="msubsup" id="MathJax-Span-1547"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.55em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.572em;"><span class="mi" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">u_t</script>. Good default values are again <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.002&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1550" style="width: 5.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.038em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.401em, 1003.99em, 2.572em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1551"><span class="mi" id="MathJax-Span-1552" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-1553" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1554" style="font-family: MathJax_Main; padding-left: 0.278em;">0.002</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 1.272em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>=</mo><mn>0.002</mn></math></span></span><script type="math/tex" id="MathJax-Element-116">\eta = 0.002</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.9&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1555" style="width: 4.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.558em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.362em, 1003.51em, 2.55em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1556"><span class="msubsup" id="MathJax-Span-1557"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1558" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1560" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1561" style="font-family: MathJax_Main; padding-left: 0.278em;">0.9</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>0.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-117">\beta_1 = 0.9</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.999&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1562" style="width: 5.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.519em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.362em, 1004.48em, 2.55em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1563"><span class="msubsup" id="MathJax-Span-1564"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1565" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1567" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1568" style="font-family: MathJax_Main; padding-left: 0.278em;">0.999</span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.294em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mn>0.999</mn></math></span></span><script type="math/tex" id="MathJax-Element-118">\beta_2 = 0.999</script>.</p>

<h2 id="nadam">Nadam</h2>

<p>As we have seen before, Adam can be viewed as a combination of 
RMSprop and momentum: RMSprop contributes the exponentially decaying 
average of past squared gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1569" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1570"><span class="msubsup" id="MathJax-Span-1571"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-119">v_t</script>, while momentum accounts for the exponentially decaying average of past gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1574" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1575"><span class="msubsup" id="MathJax-Span-1576"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1577" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1578" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-120">m_t</script>. We have also seen that Nesterov accelerated gradient (NAG) is superior to vanilla momentum. </p>

<p>Nadam (Nesterov-accelerated Adaptive Moment Estimation) [<sup id="fnref:24"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:24" rel="footnote">24</a></sup>] thus combines Adam and NAG. In order to incorporate NAG into Adam, we need to modify its momentum term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1579" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1580"><span class="msubsup" id="MathJax-Span-1581"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1582" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-121">m_t</script>. </p>

<p>First, let us recall the momentum update rule using our current notation :</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1584" style="width: 11.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.894em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.028em, 1008.56em, 3.951em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1585"><span class="mtable" id="MathJax-Span-1586" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 8.558em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1008.39em, 6.451em, -1000em); top: -4.712em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.558em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1008.39em, 6.451em, -1000em); top: -4.712em; right: 0em;"><span class="mtd" id="MathJax-Span-1587"><span class="mrow" id="MathJax-Span-1588"><span class="mtable" id="MathJax-Span-1589" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 8.224em; height: 0px;"><span style="position: absolute; clip: rect(2.446em, 1001.7em, 6.066em, -1000em); top: -4.327em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.81em, 4.34em, -1000em); top: -5.285em; right: 0em;"><span class="mtd" id="MathJax-Span-1590"><span class="mrow" id="MathJax-Span-1591"><span class="msubsup" id="MathJax-Span-1592"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -3.92em; right: 0em;"><span class="mtd" id="MathJax-Span-1612"><span class="mrow" id="MathJax-Span-1613"><span class="msubsup" id="MathJax-Span-1614"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1615" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.604em; right: 0em;"><span class="mtd" id="MathJax-Span-1634"><span class="mrow" id="MathJax-Span-1635"><span class="msubsup" id="MathJax-Span-1636"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1637" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1638"><span class="mrow" id="MathJax-Span-1639"><span class="mi" id="MathJax-Span-1640" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1641" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1642" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.327em;"></span></span><span style="position: absolute; clip: rect(2.378em, 1006.52em, 6.256em, -1000em); top: -4.567em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 6.521em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1004.92em, 4.4em, -1000em); top: -5.285em; left: 0em;"><span class="mtd" id="MathJax-Span-1595"><span class="mrow" id="MathJax-Span-1596"><span class="mi" id="MathJax-Span-1597"></span><span class="mo" id="MathJax-Span-1598" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1599" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="texatom" id="MathJax-Span-1601"><span class="mrow" id="MathJax-Span-1602"><span class="msubsup" id="MathJax-Span-1603"><span style="display: inline-block; position: relative; width: 0.565em; height: 0px;"><span style="position: absolute; clip: rect(3.348em, 1000.33em, 4.142em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.884em; left: 0.332em;"><span class="mi" id="MathJax-Span-1605" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1606" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1607" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1608"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1609" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1610" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1611" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.263em, 1006.52em, 4.351em, -1000em); top: -3.92em; left: 0em;"><span class="mtd" id="MathJax-Span-1617"><span class="mrow" id="MathJax-Span-1618"><span class="mi" id="MathJax-Span-1619"></span><span class="mo" id="MathJax-Span-1620" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-1621" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1622"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1623" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1624"><span class="mrow" id="MathJax-Span-1625"><span class="mi" id="MathJax-Span-1626" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1627" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1629" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1630" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-1631"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1633" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1004.56em, 4.292em, -1000em); top: -2.604em; left: 0em;"><span class="mtd" id="MathJax-Span-1643"><span class="mrow" id="MathJax-Span-1644"><span class="mi" id="MathJax-Span-1645"></span><span class="mo" id="MathJax-Span-1646" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1647" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1650" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1651" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1653" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.567em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.136em; border-left: 0px solid; width: 0px; height: 4.922em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>g</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mi>t</mi></msub></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-122">
\begin{align}
\begin{split}
g_t &= \nabla_{\theta_t}J(\theta_t)\\  
m_t &= \gamma m_{t-1} + \eta g_t\\  
\theta_{t+1} &= \theta_t - m_t
\end{split}
\end{align}
</script></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1654" style="width: 0.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.673em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.144em, 1000.67em, 2.137em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1655"><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 1.042em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">J</script> is our objective function, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1657" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.577em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.386em, 1000.58em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1658"><span class="mi" id="MathJax-Span-1659" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">\gamma</script> is the momentum decay term, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1660" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.385em, 1000.48em, 2.331em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-1661"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.343em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">\eta</script> is our step size. Expanding the third equation above yields:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1663" style="width: 14.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.962em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.365em, 1010.87em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-1664"><span class="msubsup" id="MathJax-Span-1665"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1667"><span class="mrow" id="MathJax-Span-1668"><span class="mi" id="MathJax-Span-1669" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1670" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1672" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1673" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1674" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1676" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mo" id="MathJax-Span-1677" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-1678" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1679"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1680" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1681"><span class="mrow" id="MathJax-Span-1682"><span class="mi" id="MathJax-Span-1683" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1684" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1685" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1686" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1687" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-1688"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1689" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1691" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>−</mo><mo stretchy="false">(</mo><mi>γ</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-126">\theta_{t+1} = \theta_t - ( \gamma m_{t-1} + \eta g_t)</script></p>

<p>This demonstrates again that momentum involves taking a step in the 
direction of the previous momentum vector and a step in the direction of
 the current gradient.</p>

<p>NAG then allows us to perform a more accurate step in the gradient direction by updating the parameters with the momentum step <em>before</em> computing the gradient. We thus only need to modify the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1692" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.82em, 1.359em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1693"><span class="msubsup" id="MathJax-Span-1694"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1695" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1696" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">g_t</script> to arrive at NAG:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1697" style="width: 14.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.25em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.028em, 1010.82em, 3.951em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1698"><span class="mtable" id="MathJax-Span-1699" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.931em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1010.67em, 6.451em, -1000em); top: -4.712em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.931em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1010.67em, 6.451em, -1000em); top: -4.712em; right: 0em;"><span class="mtd" id="MathJax-Span-1700"><span class="mrow" id="MathJax-Span-1701"><span class="mtable" id="MathJax-Span-1702" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.597em; height: 0px;"><span style="position: absolute; clip: rect(2.446em, 1001.7em, 6.066em, -1000em); top: -4.327em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.81em, 4.34em, -1000em); top: -5.285em; right: 0em;"><span class="mtd" id="MathJax-Span-1703"><span class="mrow" id="MathJax-Span-1704"><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -3.92em; right: 0em;"><span class="mtd" id="MathJax-Span-1734"><span class="mrow" id="MathJax-Span-1735"><span class="msubsup" id="MathJax-Span-1736"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1737" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1738" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.604em; right: 0em;"><span class="mtd" id="MathJax-Span-1756"><span class="mrow" id="MathJax-Span-1757"><span class="msubsup" id="MathJax-Span-1758"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1759" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1760"><span class="mrow" id="MathJax-Span-1761"><span class="mi" id="MathJax-Span-1762" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1763" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1764" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.327em;"></span></span><span style="position: absolute; clip: rect(2.378em, 1008.8em, 6.256em, -1000em); top: -4.567em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 8.894em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1008.8em, 4.4em, -1000em); top: -5.285em; left: 0em;"><span class="mtd" id="MathJax-Span-1708"><span class="mrow" id="MathJax-Span-1709"><span class="mi" id="MathJax-Span-1710"></span><span class="mo" id="MathJax-Span-1711" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1712" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="texatom" id="MathJax-Span-1714"><span class="mrow" id="MathJax-Span-1715"><span class="msubsup" id="MathJax-Span-1716"><span style="display: inline-block; position: relative; width: 0.565em; height: 0px;"><span style="position: absolute; clip: rect(3.348em, 1000.33em, 4.142em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1717" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.884em; left: 0.332em;"><span class="mi" id="MathJax-Span-1718" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1719" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1720" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1721"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1722" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1724" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1726"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1728"><span class="mrow" id="MathJax-Span-1729"><span class="mi" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1731" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.263em, 1006.52em, 4.351em, -1000em); top: -3.92em; left: 0em;"><span class="mtd" id="MathJax-Span-1739"><span class="mrow" id="MathJax-Span-1740"><span class="mi" id="MathJax-Span-1741"></span><span class="mo" id="MathJax-Span-1742" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-1743" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1744"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1745" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1746"><span class="mrow" id="MathJax-Span-1747"><span class="mi" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1749" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1751" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1752" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-1753"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1754" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1004.56em, 4.292em, -1000em); top: -2.604em; left: 0em;"><span class="mtd" id="MathJax-Span-1765"><span class="mrow" id="MathJax-Span-1766"><span class="mi" id="MathJax-Span-1767"></span><span class="mo" id="MathJax-Span-1768" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1769" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1770" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1771" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1772" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1773" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1774" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1775" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.567em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.136em; border-left: 0px solid; width: 0px; height: 4.922em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>g</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mi>t</mi></msub></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>−</mo><mi>γ</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-128">
\begin{align}
\begin{split}
g_t &= \nabla_{\theta_t}J(\theta_t - \gamma m_{t-1})\\  
m_t &= \gamma m_{t-1} + \eta g_t\\  
\theta_{t+1} &= \theta_t - m_t
\end{split}
\end{align}
</script></p>

<p>Dozat proposes to modify NAG the following way: Rather than applying 
the momentum step twice -- one time for updating the gradient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1776" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1000.82em, 1.359em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1777"><span class="msubsup" id="MathJax-Span-1778"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1779" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1780" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-129">g_t</script> and a second time for updating the parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1781" style="width: 2.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.683em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.16em, 1001.68em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1782"><span class="msubsup" id="MathJax-Span-1783"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1784" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1785"><span class="mrow" id="MathJax-Span-1786"><span class="mi" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1788" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1789" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-130">\theta_{t+1}</script> -- we now apply the look-ahead momentum vector directly to update the current parameters:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1790" style="width: 14.041em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.769em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.049em, 1010.34em, 3.972em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1791"><span class="mtable" id="MathJax-Span-1792" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.454em; height: 0px;"><span style="position: absolute; clip: rect(2.451em, 1010.19em, 6.472em, -1000em); top: -4.712em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.454em; height: 0px;"><span style="position: absolute; clip: rect(2.451em, 1010.19em, 6.472em, -1000em); top: -4.712em; right: 0em;"><span class="mtd" id="MathJax-Span-1793"><span class="mrow" id="MathJax-Span-1794"><span class="mtable" id="MathJax-Span-1795" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.12em; height: 0px;"><span style="position: absolute; clip: rect(2.425em, 1001.7em, 6.045em, -1000em); top: -4.327em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.81em, 4.34em, -1000em); top: -5.306em; right: 0em;"><span class="mtd" id="MathJax-Span-1796"><span class="mrow" id="MathJax-Span-1797"><span class="msubsup" id="MathJax-Span-1798"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -3.941em; right: 0em;"><span class="mtd" id="MathJax-Span-1818"><span class="mrow" id="MathJax-Span-1819"><span class="msubsup" id="MathJax-Span-1820"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1822" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.625em; right: 0em;"><span class="mtd" id="MathJax-Span-1840"><span class="mrow" id="MathJax-Span-1841"><span class="msubsup" id="MathJax-Span-1842"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1843" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1844"><span class="mrow" id="MathJax-Span-1845"><span class="mi" id="MathJax-Span-1846" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1847" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1848" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.327em;"></span></span><span style="position: absolute; clip: rect(2.453em, 1008.32em, 6.424em, -1000em); top: -4.663em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 8.417em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1004.92em, 4.4em, -1000em); top: -5.306em; left: 0em;"><span class="mtd" id="MathJax-Span-1801"><span class="mrow" id="MathJax-Span-1802"><span class="mi" id="MathJax-Span-1803"></span><span class="mo" id="MathJax-Span-1804" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1805" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.163em, 1000.79em, 4.168em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1806" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.833em;"><span class="texatom" id="MathJax-Span-1807"><span class="mrow" id="MathJax-Span-1808"><span class="msubsup" id="MathJax-Span-1809"><span style="display: inline-block; position: relative; width: 0.565em; height: 0px;"><span style="position: absolute; clip: rect(3.348em, 1000.33em, 4.142em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1810" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.884em; left: 0.332em;"><span class="mi" id="MathJax-Span-1811" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1813" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1814"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1815" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1816" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1817" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.263em, 1006.52em, 4.351em, -1000em); top: -3.941em; left: 0em;"><span class="mtd" id="MathJax-Span-1823"><span class="mrow" id="MathJax-Span-1824"><span class="mi" id="MathJax-Span-1825"></span><span class="mo" id="MathJax-Span-1826" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-1827" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1828"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1829" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1830"><span class="mrow" id="MathJax-Span-1831"><span class="mi" id="MathJax-Span-1832" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1833" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1834" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1835" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1836" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-1837"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1838" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1839" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1008.32em, 4.385em, -1000em); top: -2.625em; left: 0em;"><span class="mtd" id="MathJax-Span-1849"><span class="mrow" id="MathJax-Span-1850"><span class="mi" id="MathJax-Span-1851"></span><span class="mo" id="MathJax-Span-1852" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1853" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1854" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="mi" id="MathJax-Span-1855" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1856" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mo" id="MathJax-Span-1857" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-1859"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1860" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1861" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1862" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1863" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-1864"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.663em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.712em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.163em; border-left: 0px solid; width: 0px; height: 4.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>g</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mi>t</mi></msub></mrow></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>η</mi><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mi>t</mi></msub><mo>−</mo><mo stretchy="false">(</mo><mi>γ</mi><msub><mi>m</mi><mi>t</mi></msub><mo>+</mo><mi>η</mi><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-131">
\begin{align}
\begin{split}
g_t &= \nabla_{\theta_t}J(\theta_t)\\  
m_t &= \gamma m_{t-1} + \eta g_t\\  
\theta_{t+1} &= \theta_t - (\gamma m_t + \eta g_t)
\end{split}
\end{align}
</script></p>

<p>Notice that rather than utilizing the previous momentum vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1868" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.115em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1002.12em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1869"><span class="msubsup" id="MathJax-Span-1870"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1872"><span class="mrow" id="MathJax-Span-1873"><span class="mi" id="MathJax-Span-1874" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1875" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1876" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 0.97em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">m_{t-1}</script> as in the equation of the expanded momentum update rule above, we now use the current momentum vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1877" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1878"><span class="msubsup" id="MathJax-Span-1879"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1880" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1881" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-133">m_t</script>
 to look ahead. In order to add Nesterov momentum to Adam, we can thus 
similarly replace the previous momentum vector with the current momentum
 vector. First, recall that the Adam update rule is the following (note 
that we do not need to modify <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1882" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.139em, 1000.87em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1883"><span class="msubsup" id="MathJax-Span-1884"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1885"><span class="mrow" id="MathJax-Span-1886"><span class="munderover" id="MathJax-Span-1887"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-1888" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-1889" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-1890" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.274em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">\hat{v}_t</script>):</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1891" style="width: 16.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.356em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-1.237em, 1012.02em, 5.16em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-1892"><span class="mtable" id="MathJax-Span-1893" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.001em; height: 0px;"><span style="position: absolute; clip: rect(3.667em, 1011.83em, 10.064em, -1000em); top: -7.115em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.001em; height: 0px;"><span style="position: absolute; clip: rect(3.667em, 1011.83em, 10.064em, -1000em); top: -7.115em; right: 0em;"><span class="mtd" id="MathJax-Span-1894"><span class="mrow" id="MathJax-Span-1895"><span class="mtable" id="MathJax-Span-1896" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.667em; height: 0px;"><span style="position: absolute; clip: rect(2.727em, 1001.7em, 7.814em, -1000em); top: -5.817em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -6.495em; right: 0em;"><span class="mtd" id="MathJax-Span-1897"><span class="mrow" id="MathJax-Span-1898"><span class="msubsup" id="MathJax-Span-1899"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1900" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1901" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.121em, 1001.21em, 4.292em, -1000em); top: -4.826em; right: 0em;"><span class="mtd" id="MathJax-Span-1927"><span class="mrow" id="MathJax-Span-1928"><span class="msubsup" id="MathJax-Span-1929"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1930"><span class="mrow" id="MathJax-Span-1931"><span class="munderover" id="MathJax-Span-1932"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1933" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1934" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1935" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.346em; right: 0em;"><span class="mtd" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="msubsup" id="MathJax-Span-1953"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1954" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1955"><span class="mrow" id="MathJax-Span-1956"><span class="mi" id="MathJax-Span-1957" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1958" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1959" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.817em;"></span></span><span style="position: absolute; clip: rect(3.669em, 1009.96em, 10.016em, -1000em); top: -7.067em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 9.964em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1009.96em, 4.385em, -1000em); top: -6.495em; left: 0em;"><span class="mtd" id="MathJax-Span-1902"><span class="mrow" id="MathJax-Span-1903"><span class="mi" id="MathJax-Span-1904"></span><span class="mo" id="MathJax-Span-1905" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1906" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1907" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1908" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1909"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1910" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-1911"><span class="mrow" id="MathJax-Span-1912"><span class="mi" id="MathJax-Span-1913" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1914" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1915" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1916" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1917" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1918" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1919" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1920" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1921" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1922" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1923" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1924"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1925" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-1926" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1004.41em, 5.196em, -1000em); top: -4.826em; left: 0em;"><span class="mtd" id="MathJax-Span-1936"><span class="mrow" id="MathJax-Span-1937"><span class="mi" id="MathJax-Span-1938"></span><span class="mo" id="MathJax-Span-1939" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-1940" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.837em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -4.667em; left: 50%; margin-left: -0.604em;"><span class="msubsup" id="MathJax-Span-1941"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1942" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1943" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-1944"><span class="mn" id="MathJax-Span-1945" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1947" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1948" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-1949" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-1950" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1002.84em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.837em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1008.52em, 5.295em, -1000em); top: -2.346em; left: 0em;"><span class="mtd" id="MathJax-Span-1960"><span class="mrow" id="MathJax-Span-1961"><span class="mi" id="MathJax-Span-1962"></span><span class="mo" id="MathJax-Span-1963" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1964" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1965" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-1966"><span class="mrow" id="MathJax-Span-1967"><span class="mi" id="MathJax-Span-1968" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1969" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-1970" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-1971" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-1972"><span class="msqrt" id="MathJax-Span-1973"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-1974"><span class="msubsup" id="MathJax-Span-1975"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1976"><span class="mrow" id="MathJax-Span-1977"><span class="munderover" id="MathJax-Span-1978"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-1979" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-1981" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1982" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-1983" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1984"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1985"><span class="mrow" id="MathJax-Span-1986"><span class="munderover" id="MathJax-Span-1987"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1988" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1989" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1990" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.067em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.115em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.115em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.708em; border-left: 0px solid; width: 0px; height: 8.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><msub><mi>m</mi><mi>t</mi></msub><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-135">
\begin{align} 
\begin{split}
m_t &= \beta_1 m_{t-1} + (1 - \beta_1) g_t\\  
\hat{m}_t & = \frac{m_t}{1 - \beta^t_1}\\
\theta_{t+1} &= \theta_{t} - \frac{\eta}{\sqrt{\hat{v}_t} + \epsilon} \hat{m}_t
\end{split}
\end{align}
</script></p>

<p>Expanding the second equation with the definitions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1991" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.14em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-1992"><span class="msubsup" id="MathJax-Span-1993"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-1994"><span class="mrow" id="MathJax-Span-1995"><span class="munderover" id="MathJax-Span-1996"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-1997" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-1998" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-1999" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.273em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-136">\hat{m}_t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2000" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.423em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2001"><span class="msubsup" id="MathJax-Span-2002"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2003" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-2004" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.905em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-137">m_t</script> in turn gives us:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2005" style="width: 24.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.087em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.655em, 1018.99em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2006"><span class="msubsup" id="MathJax-Span-2007"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2008" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="mi" id="MathJax-Span-2011" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2013" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2014" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2015" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2017"><span class="mrow" id="MathJax-Span-2018"><span class="mi" id="MathJax-Span-2019" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2020" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-2021" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2022"><span class="mfrac" id="MathJax-Span-2023"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-2024" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-2025"><span class="msqrt" id="MathJax-Span-2026"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-2027"><span class="msubsup" id="MathJax-Span-2028"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2029"><span class="mrow" id="MathJax-Span-2030"><span class="munderover" id="MathJax-Span-2031"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2032" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2033" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2034" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2035" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2036" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main;">(</span><span class="mstyle" id="MathJax-Span-2038"><span class="mrow" id="MathJax-Span-2039"><span class="mfrac" id="MathJax-Span-2040"><span style="display: inline-block; position: relative; width: 3.227em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.141em, 1003.11em, 4.343em, -1000em); top: -4.667em; left: 50%; margin-left: -1.553em;"><span class="mrow" id="MathJax-Span-2041"><span class="msubsup" id="MathJax-Span-2042"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2043" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2044" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2045"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2046" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2047"><span class="mrow" id="MathJax-Span-2048"><span class="mi" id="MathJax-Span-2049" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2050" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-2052"><span class="mn" id="MathJax-Span-2053" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2054" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2055" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2056" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2057" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2058" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.23em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.227em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2059" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mstyle" id="MathJax-Span-2060" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2061"><span class="mfrac" id="MathJax-Span-2062"><span style="display: inline-block; position: relative; width: 4.422em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.096em, 1004.3em, 4.385em, -1000em); top: -4.701em; left: 50%; margin-left: -2.151em;"><span class="mrow" id="MathJax-Span-2063"><span class="mo" id="MathJax-Span-2064" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2065" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2066" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2067" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2068" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2069" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2070" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2071"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2072" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-2073" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-2074"><span class="mn" id="MathJax-Span-2075" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2076" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2077" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2078" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2079" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2080" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1004.42em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2081" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.532em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>β</mi><mn>1</mn></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-138">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{\sqrt{\hat{v}_t} + \epsilon} (\dfrac{\beta_1 m_{t-1}}{1 - \beta^t_1} + \dfrac{(1 - \beta_1) g_t}{1 - \beta^t_1})</script></p>

<p>Note that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2082" style="width: 4.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.462em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.516em, 1003.46em, 2.215em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2083"><span class="mstyle" id="MathJax-Span-2084"><span class="mrow" id="MathJax-Span-2085"><span class="mfrac" id="MathJax-Span-2086"><span style="display: inline-block; position: relative; width: 3.227em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.141em, 1003.11em, 4.343em, -1000em); top: -4.667em; left: 50%; margin-left: -1.553em;"><span class="mrow" id="MathJax-Span-2087"><span class="msubsup" id="MathJax-Span-2088"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2089" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2090" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2091"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2092" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2093"><span class="mrow" id="MathJax-Span-2094"><span class="mi" id="MathJax-Span-2095" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2096" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2097" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-2098"><span class="mn" id="MathJax-Span-2099" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2100" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2101" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2102" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2103" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2104" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.23em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.227em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.443em; border-left: 0px solid; width: 0px; height: 3.301em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>β</mi><mn>1</mn></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-139">\dfrac{\beta_1 m_{t-1}}{1 - \beta^t_1}</script> is just the bias-corrected estimate of the momentum vector of the previous time step. We can thus replace it with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2105" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.115em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.14em, 1002.12em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2106"><span class="msubsup" id="MathJax-Span-2107"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2108"><span class="mrow" id="MathJax-Span-2109"><span class="munderover" id="MathJax-Span-2110"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2111" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-2112" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2113"><span class="mrow" id="MathJax-Span-2114"><span class="mi" id="MathJax-Span-2115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2117" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 1.338em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-140">\hat{m}_{t-1}</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2118" style="width: 24.377em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.75em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.655em, 1018.66em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2119"><span class="msubsup" id="MathJax-Span-2120"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2122"><span class="mrow" id="MathJax-Span-2123"><span class="mi" id="MathJax-Span-2124" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2125" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2126" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2127" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2128" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2129" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2130"><span class="mrow" id="MathJax-Span-2131"><span class="mi" id="MathJax-Span-2132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-2134" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2135"><span class="mfrac" id="MathJax-Span-2136"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-2137" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-2138"><span class="msqrt" id="MathJax-Span-2139"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-2140"><span class="msubsup" id="MathJax-Span-2141"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2142"><span class="mrow" id="MathJax-Span-2143"><span class="munderover" id="MathJax-Span-2144"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2145" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2146" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2147" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2148" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2150" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2151"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2152" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2153" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2154"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2155"><span class="mrow" id="MathJax-Span-2156"><span class="munderover" id="MathJax-Span-2157"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-2159" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2160"><span class="mrow" id="MathJax-Span-2161"><span class="mi" id="MathJax-Span-2162" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2164" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2165" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mstyle" id="MathJax-Span-2166" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2167"><span class="mfrac" id="MathJax-Span-2168"><span style="display: inline-block; position: relative; width: 4.422em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.096em, 1004.3em, 4.385em, -1000em); top: -4.701em; left: 50%; margin-left: -2.151em;"><span class="mrow" id="MathJax-Span-2169"><span class="mo" id="MathJax-Span-2170" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2171" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2172" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2173" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2174" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2175" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2176" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2177"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2178" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-2179" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-2180"><span class="mn" id="MathJax-Span-2181" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2182" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2183" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2184" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2185" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2186" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1004.42em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2187" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.532em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-141">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{\sqrt{\hat{v}_t} + \epsilon} (\beta_1 \hat{m}_{t-1} + \dfrac{(1 - \beta_1) g_t}{1 - \beta^t_1})</script></p>

<p>Note that for simplicity, we ignore that the denominator is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2188" style="width: 3.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.692em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.321em, 1002.69em, 2.71em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2189"><span class="mn" id="MathJax-Span-2190" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2191" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2192" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2193" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2194" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2195" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.461em; border-left: 0px solid; width: 0px; height: 1.557em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-142">1 - \beta^t_1</script> and not <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2196" style="width: 4.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.558em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.242em, 1003.56em, 2.71em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2197"><span class="mn" id="MathJax-Span-2198" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2199" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2200" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.859em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2201" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1001.23em, 4.193em, -1000em); top: -4.393em; left: 0.625em;"><span class="texatom" id="MathJax-Span-2202"><span class="mrow" id="MathJax-Span-2203"><span class="mi" id="MathJax-Span-2204" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2205" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2206" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2207" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.461em; border-left: 0px solid; width: 0px; height: 1.659em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-143">1 - \beta^{t-1}_1</script>
 as we will replace the denominator in the next step anyway. This 
equation again looks very similar to our expanded momentum update rule 
above. We can now add Nesterov momentum just as we did previously by 
simply replacing this bias-corrected estimate of the momentum vector of 
the previous time step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2208" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.115em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.14em, 1002.12em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2209"><span class="msubsup" id="MathJax-Span-2210"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2211"><span class="mrow" id="MathJax-Span-2212"><span class="munderover" id="MathJax-Span-2213"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2214" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-2215" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2216"><span class="mrow" id="MathJax-Span-2217"><span class="mi" id="MathJax-Span-2218" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2219" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 1.338em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-144">\hat{m}_{t-1}</script> with the bias-corrected estimate of the current momentum vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2221" style="width: 1.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.14em, 1001.2em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2222"><span class="msubsup" id="MathJax-Span-2223"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2224"><span class="mrow" id="MathJax-Span-2225"><span class="munderover" id="MathJax-Span-2226"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2227" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-2228" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-2229" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.273em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-145">\hat{m}_t</script>, which gives us the Nadam update rule:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2230" style="width: 23.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.837em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.655em, 1017.74em, 3.564em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2231"><span class="msubsup" id="MathJax-Span-2232"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2233" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2234"><span class="mrow" id="MathJax-Span-2235"><span class="mi" id="MathJax-Span-2236" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2237" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2238" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2239" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2240" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2241" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2242"><span class="mrow" id="MathJax-Span-2243"><span class="mi" id="MathJax-Span-2244" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2245" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-2246" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2247"><span class="mfrac" id="MathJax-Span-2248"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-2249" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-2250"><span class="msqrt" id="MathJax-Span-2251"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-2252"><span class="msubsup" id="MathJax-Span-2253"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2254"><span class="mrow" id="MathJax-Span-2255"><span class="munderover" id="MathJax-Span-2256"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2257" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2258" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2259" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2260" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2261" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2262" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2263"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2264" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2265" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2266"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.121em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2267"><span class="mrow" id="MathJax-Span-2268"><span class="munderover" id="MathJax-Span-2269"><span style="display: inline-block; position: relative; width: 0.878em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2270" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.022em; left: 0.189em;"><span class="mo" id="MathJax-Span-2271" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-2272" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2273" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mstyle" id="MathJax-Span-2274" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2275"><span class="mfrac" id="MathJax-Span-2276"><span style="display: inline-block; position: relative; width: 4.422em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.096em, 1004.3em, 4.385em, -1000em); top: -4.701em; left: 50%; margin-left: -2.151em;"><span class="mrow" id="MathJax-Span-2277"><span class="mo" id="MathJax-Span-2278" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2279" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2280" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2281" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2282" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2283" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2284" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2285"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2286" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.051em, 1002.72em, 4.441em, -1000em); top: -3.235em; left: 50%; margin-left: -1.358em;"><span class="mrow" id="MathJax-Span-2288"><span class="mn" id="MathJax-Span-2289" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2290" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2291" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2292" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -4.343em; left: 0.625em;"><span class="mi" id="MathJax-Span-2293" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -3.684em; left: 0.566em;"><span class="mn" id="MathJax-Span-2294" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1004.42em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.422em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2295" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.571em; border-left: 0px solid; width: 0px; height: 3.532em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>m</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>β</mi><mn>1</mn><mi>t</mi></msubsup></mrow></mfrac></mstyle><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-146">\theta_{t+1} = \theta_{t} - \dfrac{\eta}{\sqrt{\hat{v}_t} + \epsilon} (\beta_1 \hat{m}_t + \dfrac{(1 - \beta_1) g_t}{1 - \beta^t_1})</script></p>

<h2 id="amsgrad">&nbsp;AMSGrad</h2>

<p>As adaptive learning rate methods have become the norm in training 
neural networks, practitioners noticed that in some cases, e.g. for 
object recognition [<sup id="fnref:26"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:26" rel="footnote">26</a></sup>] or machine translation [<sup id="fnref:27"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:27" rel="footnote">27</a></sup>] they fail to converge to an optimal solution and are outperformed by SGD with momentum. </p>

<p>Reddi et al. (2018) [<sup id="fnref:28"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:28" rel="footnote">28</a></sup>]
 formalize this issue and pinpoint the exponential moving average of 
past squared gradients as a reason for the poor generalization behaviour
 of adaptive learning rate methods. Recall that the introduction of the 
exponential average was well-motivated: It should prevent the learning 
rates to become infinitesimally small as training progresses, the key 
flaw of the Adagrad algorithm. However, this short-term memory of the 
gradients becomes an obstacle in other scenarios.</p>

<p>In settings where Adam converges to a suboptimal solution, it has 
been observed that some minibatches provide large and informative 
gradients, but as these minibatches only occur rarely, exponential 
averaging diminishes their influence, which leads to poor convergence. 
The authors provide an example for a simple convex optimization problem 
where the same behaviour can be observed for Adam.</p>

<p>To fix this behaviour, the authors propose a new algorithm, AMSGrad that uses the maximum of past squared gradients <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2296" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2297"><span class="msubsup" id="MathJax-Span-2298"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2299" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2300" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-147">v_t</script> rather than the exponential average to update the parameters. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2301" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2302"><span class="msubsup" id="MathJax-Span-2303"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2304" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2305" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-148">v_t</script> is defined the same as in Adam above:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2306" style="width: 13.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.481em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1010.48em, 2.69em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2307"><span class="msubsup" id="MathJax-Span-2308"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2309" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2311" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2312" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2313" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2314" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2315"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2316" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-2317"><span class="mrow" id="MathJax-Span-2318"><span class="mi" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2320" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2321" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2322" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-2323" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-2324" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2325" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2326" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2328" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2329" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2330"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2331" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.531em;"><span class="mn" id="MathJax-Span-2332" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.477em;"><span class="mi" id="MathJax-Span-2333" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.557em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-149">
v_t = \beta_2 v_{t-1} + (1 - \beta_2) g_t^2  
</script></p>

<p>Instead of using <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2334" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.817em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1000.82em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2335"><span class="msubsup" id="MathJax-Span-2336"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2337" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2338" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-150">v_t</script> (or its bias-corrected version <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2339" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.139em, 1000.87em, 1.312em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2340"><span class="msubsup" id="MathJax-Span-2341"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2342"><span class="mrow" id="MathJax-Span-2343"><span class="munderover" id="MathJax-Span-2344"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2345" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2346" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2347" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.268em; border-left: 0px solid; width: 0px; height: 1.274em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-151">\hat{v}_t</script>) directly, we now employ the previous <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2348" style="width: 2.262em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.731em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.422em, 1001.73em, 1.362em, -1000em); top: -1.01em; left: 0em;"><span class="mrow" id="MathJax-Span-2349"><span class="msubsup" id="MathJax-Span-2350"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2351" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-2352"><span class="mrow" id="MathJax-Span-2353"><span class="mi" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2355" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.01em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.333em; border-left: 0px solid; width: 0px; height: 0.971em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-152">v_{t-1}</script> if it is larger than the current one:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2357" style="width: 10.147em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.788em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.365em, 1007.69em, 2.654em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2358"><span class="msubsup" id="MathJax-Span-2359"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2360"><span class="mrow" id="MathJax-Span-2361"><span class="munderover" id="MathJax-Span-2362"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2363" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2364" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2365" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2366" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mtext" id="MathJax-Span-2367" style="font-family: MathJax_Main; padding-left: 0.278em;">max</span><span class="mo" id="MathJax-Span-2368" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2369"><span style="display: inline-block; position: relative; width: 1.762em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2370"><span class="mrow" id="MathJax-Span-2371"><span class="munderover" id="MathJax-Span-2372"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2373" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2374" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="texatom" id="MathJax-Span-2375"><span class="mrow" id="MathJax-Span-2376"><span class="mi" id="MathJax-Span-2377" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2378" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2379" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2380" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2381" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2382" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2383" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2384" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.425em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><mtext>max</mtext><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>v</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">
\hat{v}_t = \text{max}(\hat{v}_{t-1}, v_t)
</script></p>

<p>This way, AMSGrad results in a non-increasing step size, which avoids
 the problems suffered by Adam. For simplicity, the authors also remove 
the debiasing step that we have seen in Adam. The full AMSGrad update 
without bias-corrected estimates can be seen below:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2385" style="width: 16.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.356em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-1.373em, 1012.02em, 5.296em, -1000em); top: -2.212em; left: 0em;"><span class="mrow" id="MathJax-Span-2386"><span class="mtable" id="MathJax-Span-2387" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.001em; height: 0px;"><span style="position: absolute; clip: rect(3.82em, 1011.83em, 10.488em, -1000em); top: -7.404em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.001em; height: 0px;"><span style="position: absolute; clip: rect(3.82em, 1011.83em, 10.488em, -1000em); top: -7.404em; right: 0em;"><span class="mtd" id="MathJax-Span-2388"><span class="mrow" id="MathJax-Span-2389"><span class="mtable" id="MathJax-Span-2390" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 11.667em; height: 0px;"><span style="position: absolute; clip: rect(2.831em, 1001.7em, 8.19em, -1000em); top: -6.058em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1001.21em, 4.292em, -1000em); top: -6.63em; right: 0em;"><span class="mtd" id="MathJax-Span-2391"><span class="mrow" id="MathJax-Span-2392"><span class="msubsup" id="MathJax-Span-2393"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2394" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-2395" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.403em, 1000.82em, 4.292em, -1000em); top: -5.265em; right: 0em;"><span class="mtd" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="msubsup" id="MathJax-Span-2423"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2424" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2425" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.879em; right: 0em;"><span class="mtd" id="MathJax-Span-2452"><span class="mrow" id="MathJax-Span-2453"><span class="msubsup" id="MathJax-Span-2454"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2455"><span class="mrow" id="MathJax-Span-2456"><span class="munderover" id="MathJax-Span-2457"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2458" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2459" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2460" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1001.7em, 4.343em, -1000em); top: -2.211em; right: 0em;"><span class="mtd" id="MathJax-Span-2483"><span class="mrow" id="MathJax-Span-2484"><span class="msubsup" id="MathJax-Span-2485"><span style="display: inline-block; position: relative; width: 1.703em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2486" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2487"><span class="mrow" id="MathJax-Span-2488"><span class="mi" id="MathJax-Span-2489" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2490" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2491" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.058em;"></span></span><span style="position: absolute; clip: rect(3.773em, 1009.96em, 10.392em, -1000em); top: -7.308em; left: 1.703em;"><span style="display: inline-block; position: relative; width: 9.964em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1009.96em, 4.385em, -1000em); top: -6.63em; left: 0em;"><span class="mtd" id="MathJax-Span-2396"><span class="mrow" id="MathJax-Span-2397"><span class="mi" id="MathJax-Span-2398"></span><span class="mo" id="MathJax-Span-2399" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2400" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2401" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2402" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2403"><span style="display: inline-block; position: relative; width: 2.112em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2404" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="texatom" id="MathJax-Span-2405"><span class="mrow" id="MathJax-Span-2406"><span class="mi" id="MathJax-Span-2407" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2408" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2409" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2410" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-2411" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-2412" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2413" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2414" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2415" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2417" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2418"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2419" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="mi" id="MathJax-Span-2420" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.031em, 1009.72em, 4.421em, -1000em); top: -5.265em; left: 0em;"><span class="mtd" id="MathJax-Span-2426"><span class="mrow" id="MathJax-Span-2427"><span class="mi" id="MathJax-Span-2428"></span><span class="mo" id="MathJax-Span-2429" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2430" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2431" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2432" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2433"><span style="display: inline-block; position: relative; width: 1.719em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2434" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="texatom" id="MathJax-Span-2435"><span class="mrow" id="MathJax-Span-2436"><span class="mi" id="MathJax-Span-2437" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2438" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2439" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2440" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-2441" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-2442" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2443" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-2444" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.995em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.57em, 4.329em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2445" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-2446" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2447" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2448"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2449" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.531em;"><span class="mn" id="MathJax-Span-2450" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.477em;"><span class="mi" id="MathJax-Span-2451" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1006.9em, 4.385em, -1000em); top: -3.879em; left: 0em;"><span class="mtd" id="MathJax-Span-2461"><span class="mrow" id="MathJax-Span-2462"><span class="mi" id="MathJax-Span-2463"></span><span class="mo" id="MathJax-Span-2464" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mtext" id="MathJax-Span-2465" style="font-family: MathJax_Main; padding-left: 0.278em;">max</span><span class="mo" id="MathJax-Span-2466" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2467"><span style="display: inline-block; position: relative; width: 1.762em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2468"><span class="mrow" id="MathJax-Span-2469"><span class="munderover" id="MathJax-Span-2470"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2471" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2472" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="texatom" id="MathJax-Span-2473"><span class="mrow" id="MathJax-Span-2474"><span class="mi" id="MathJax-Span-2475" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2476" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2477" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2478" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2479" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.815em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2480" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.485em;"><span class="mi" id="MathJax-Span-2481" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2482" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.728em, 1008.52em, 5.295em, -1000em); top: -2.211em; left: 0em;"><span class="mtd" id="MathJax-Span-2492"><span class="mrow" id="MathJax-Span-2493"><span class="mi" id="MathJax-Span-2494"></span><span class="mo" id="MathJax-Span-2495" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2496" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.46em, 4.145em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2497" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.469em;"><span class="texatom" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mi" id="MathJax-Span-2500" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2501" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mstyle" id="MathJax-Span-2502" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-2503"><span class="mfrac" id="MathJax-Span-2504"><span style="display: inline-block; position: relative; width: 3.715em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-2505" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.947em, 1003.57em, 4.435em, -1000em); top: -3.131em; left: 50%; margin-left: -1.798em;"><span class="mrow" id="MathJax-Span-2506"><span class="msqrt" id="MathJax-Span-2507"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.86em, 4.292em, -1000em); top: -3.99em; left: 1em;"><span class="mrow" id="MathJax-Span-2508"><span class="msubsup" id="MathJax-Span-2509"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.12em, 1000.48em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="texatom" id="MathJax-Span-2510"><span class="mrow" id="MathJax-Span-2511"><span class="munderover" id="MathJax-Span-2512"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.403em, 1000.47em, 4.146em, -1000em); top: -3.99em; left: 0.008em;"><span class="mi" id="MathJax-Span-2513" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.39em, 3.604em, -1000em); top: -4.023em; left: 0.028em;"><span class="mo" id="MathJax-Span-2514" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.528em;"><span class="mi" id="MathJax-Span-2515" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.573em, 1000.97em, 3.907em, -1000em); top: -4.617em; left: 1em;"><span style="display: inline-block; position: relative; width: 0.967em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.99em; left: 0.273em;">−<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.02em, 4.485em, -1000em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2516" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2517" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.72em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.715em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-2518"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.86em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2519" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.878em;"><span class="mi" id="MathJax-Span-2520" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.308em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.404em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.404em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.212em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.885em; border-left: 0px solid; width: 0px; height: 8.419em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtable columnalign="right left" rowspacing="3pt" columnspacing="0em" displaystyle="true"><mtr><mtd><msub><mi>m</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>v</mi><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msubsup><mi>g</mi><mi>t</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></mtd><mtd><mi></mi><mo>=</mo><mtext>max</mtext><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>v</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><msqrt><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></msqrt><mo>+</mo><mi>ϵ</mi></mrow></mfrac></mstyle><msub><mi>m</mi><mi>t</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-154">
\begin{align}
\begin{split}
m_t &= \beta_1 m_{t-1} + (1 - \beta_1) g_t \\  
v_t &= \beta_2 v_{t-1} + (1 - \beta_2) g_t^2\\  
\hat{v}_t &= \text{max}(\hat{v}_{t-1}, v_t) \\
\theta_{t+1} &= \theta_{t} - \dfrac{\eta}{\sqrt{\hat{v}_t} + \epsilon} m_t
\end{split}
\end{align}
</script></p>

<p>The authors observe improved performance compared to Adam on small datasets and on CIFAR-10. <a href="https://fdlm.github.io/post/amsgrad/">Other experiments</a>,
 however, show similar or worse performance than Adam. It remains to be 
seen whether AMSGrad is able to consistently outperform Adam in 
practice. For more information about recent advances in Deep Learning 
optimization, refer to <a href="http://ruder.io/deep-learning-optimization-2017/">this blog post</a>.</p>

<h2 id="visualizationofalgorithms">Visualization of algorithms</h2>

<p>The following two animations (Image credit: <a href="https://twitter.com/alecrad">Alec Radford</a>) provide some intuitions towards the optimization behaviour of most of the presented optimization methods. Also have a look <a href="http://cs231n.github.io/neural-networks-3/">here</a> for a description of the same images by Karpathy and another concise overview of the algorithms discussed.</p>

<p>In Image 5, we see their behaviour on the contours of a loss surface (<a href="https://www.sfu.ca/~ssurjano/beale.html">the Beale function</a>)
 over time. Note that Adagrad, Adadelta, and RMSprop almost immediately 
head off in the right direction and converge similarly fast, while 
Momentum and NAG are led off-track, evoking the image of a ball rolling 
down the hill. NAG, however, is quickly able to correct its course due 
to its increased responsiveness by looking ahead and heads to the 
minimum.</p>

<p>Image 6 shows the behaviour of the algorithms at a saddle point, i.e.
 a point where one dimension has a positive slope, while the other 
dimension has a negative slope, which pose a difficulty for SGD as we 
mentioned before. Notice here that SGD, Momentum, and NAG find it 
difficulty to break symmetry, although the two latter eventually manage 
to escape the saddle point, while Adagrad, RMSprop, and Adadelta quickly
 head down the negative slope.</p>

<table>  
  <tbody><tr>
    <td style="padding:1px">
      <figure>
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/contours_evaluation_optimizers.gif" style="width: 90%; height: 90%" title="SGD without momentum">
<figcaption>Image 5: SGD optimization on loss surface contours</figcaption>  
</figure>  
    </td>
    <td style="padding:1px">
      <figure>
      <img src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/saddle_point_evaluation_optimizers.gif" style="width: 90%; height: 90%" title="SGD with momentum">
<figcaption>Image 6: SGD optimization on saddle point</figcaption>  
</figure>  
    </td>
  </tr>
</tbody></table>

<p>As we can see, the adaptive learning-rate methods, i.e. Adagrad, 
Adadelta, RMSprop, and Adam are most suitable and provide the best 
convergence for these scenarios.</p>

<p>Note: If you are interested in visualizing these or other optimization algorithms, refer to <a href="http://louistiao.me/notes/visualizing-and-animating-optimization-algorithms-with-matplotlib/">this useful tutorial</a>.</p>

<h2 id="whichoptimizertouse">Which optimizer to use?</h2>

<p>So, which optimizer should you now use? If your input data is sparse,
 then you likely achieve the best results using one of the adaptive 
learning-rate methods. An additional benefit is that you won't need to 
tune the learning rate but likely achieve the best results with the 
default value.</p>

<p>In summary, RMSprop is an extension of Adagrad that deals with its 
radically diminishing learning rates. It is identical to Adadelta, 
except that Adadelta uses the RMS of parameter updates in the numinator 
update rule. Adam, finally, adds bias-correction and momentum to 
RMSprop. Insofar, RMSprop, Adadelta, and Adam are very similar 
algorithms that do well in similar circumstances. Kingma et al. [<sup id="fnref:15"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:15" rel="footnote">15</a></sup>]
 show that its bias-correction helps Adam slightly outperform RMSprop 
towards the end of optimization as gradients become sparser. Insofar, 
Adam might be the best overall choice.</p>

<p>Interestingly, many recent papers use vanilla SGD without momentum 
and a simple learning rate annealing schedule. As has been shown, SGD 
usually achieves to find a minimum, but it might take significantly 
longer than with some of the optimizers, is much more reliant on a 
robust initialization and annealing schedule, and may get stuck in 
saddle points rather than local minima. Consequently, if you care about 
fast convergence and train a deep or complex neural network, you should 
choose one of the adaptive learning rate methods.</p>

<h1 id="parallelizinganddistributingsgd">Parallelizing and distributing SGD</h1>

<p>Given the ubiquity of large-scale data solutions and the availability
 of low-commodity clusters, distributing SGD to speed it up further is 
an obvious choice. <br>
SGD by itself is inherently sequential: Step-by-step, we progress 
further towards the minimum. Running it provides good convergence but 
can be slow particularly on large datasets. In contrast, running SGD 
asynchronously is faster, but suboptimal communication between workers 
can lead to poor convergence. Additionally, we can also parallelize SGD 
on one machine without the need for a large computing cluster. The 
following are algorithms and architectures that have been proposed to 
optimize parallelized and distributed SGD.</p>

<h2 id="hogwild">Hogwild!</h2>

<p>Niu et al. [<sup id="fnref:23"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:23" rel="footnote">23</a></sup>]
 introduce an update scheme called Hogwild! that allows performing SGD 
updates in parallel on CPUs. Processors are allowed to access shared 
memory without locking the parameters. This only works if the input data
 is sparse, as each update will only modify a fraction of all 
parameters. They show that in this case, the update scheme achieves 
almost an optimal rate of convergence, as it is unlikely that processors
 will overwrite useful information.</p>

<h2 id="downpoursgd">Downpour SGD</h2>

<p>Downpour SGD is an asynchronous variant of SGD that was used by Dean et al. [<sup id="fnref:4"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:4" rel="footnote">4</a></sup>]
 in their DistBelief framework (predecessor to TensorFlow) at Google. It
 runs multiple replicas of a model in parallel on subsets of the 
training data. These models send their updates to a parameter server, 
which is split across many machines. Each machine is responsible for 
storing and updating a fraction of the model's parameters. However, as 
replicas don't communicate with each other e.g. by sharing weights or 
updates, their parameters are continuously at risk of diverging, 
hindering convergence.</p>

<h2 id="delaytolerantalgorithmsforsgd">Delay-tolerant Algorithms for SGD</h2>

<p>McMahan and Streeter [<sup id="fnref:12"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:12" rel="footnote">12</a></sup>]
 extend AdaGrad to the parallel setting by developing delay-tolerant 
algorithms that not only adapt to past gradients, but also to the update
 delays. This has been shown to work well in practice.</p>

<h2 id="tensorflow">TensorFlow</h2>

<p><a href="https://www.tensorflow.org/">TensorFlow</a> [<sup id="fnref:13"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:13" rel="footnote">13</a></sup>]
 is Google's recently open-sourced framework for the implementation and 
deployment of large-scale machine learning models. It is based on their 
experience with DistBelief and is already used internally to perform 
computations on a large range of mobile devices as well as on 
large-scale distributed systems. For distributed execution, a 
computation graph is split into a subgraph for every device and 
communication takes place using Send/Receive node pairs. However, the 
open source version of TensorFlow currently does not support distributed
 functionality (see <a href="https://github.com/tensorflow/tensorflow/issues/23">here</a>).
Update 13.04.16: A distributed version of TensorFlow has <a href="http://googleresearch.blogspot.ie/2016/04/announcing-tensorflow-08-now-with.html">been released</a>.</p>

<h2 id="elasticaveragingsgd">&nbsp;Elastic Averaging SGD</h2>

<p>Zhang et al. [<sup id="fnref:14"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:14" rel="footnote">14</a></sup>]
 propose Elastic Averaging SGD (EASGD), which links the parameters of 
the workers of asynchronous SGD with an elastic force, i.e. a center 
variable stored by the parameter server. This allows the local variables
 to fluctuate further from the center variable, which in theory allows 
for more exploration of the parameter space. They show empirically that 
this increased capacity for exploration leads to improved performance by
 finding new local optima.</p>

<h1 id="additionalstrategiesforoptimizingsgd">Additional strategies for optimizing SGD</h1>

<p>Finally, we introduce additional strategies that can be used 
alongside any of the previously mentioned algorithms to further improve 
the performance of SGD. For a great overview of some other common 
tricks, refer to [<sup id="fnref:22"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:22" rel="footnote">22</a></sup>].</p>

<h2 id="shufflingandcurriculumlearning">Shuffling and Curriculum Learning</h2>

<p>Generally, we want to avoid providing the training examples in a 
meaningful order to our model as this may bias the optimization 
algorithm. Consequently, it is often a good idea to shuffle the training
 data after every epoch. </p>

<p>On the other hand, for some cases where we aim to solve progressively
 harder problems, supplying the training examples in a meaningful order 
may actually lead to improved performance and better convergence. The 
method for establishing this meaningful order is called Curriculum 
Learning [<sup id="fnref:16"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:16" rel="footnote">16</a></sup>]. </p>

<p>Zaremba and Sutskever [<sup id="fnref:17"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:17" rel="footnote">17</a></sup>]
 were only able to train LSTMs to evaluate simple programs using 
Curriculum Learning and show that a combined or mixed strategy is better
 than the naive one, which sorts examples by increasing difficulty.</p>

<h2 id="batchnormalization">Batch normalization</h2>

<p>To facilitate learning, we typically normalize the initial values of 
our parameters by initializing them with zero mean and unit variance. As
 training progresses and we update parameters to different extents, we 
lose this normalization, which slows down training and amplifies changes
 as the network becomes deeper.</p>

<p>Batch normalization [<sup id="fnref:18"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:18" rel="footnote">18</a></sup>]
 reestablishes these normalizations for every mini-batch and changes are
 back-propagated through the operation as well. By making normalization 
part of the model architecture, we are able to use higher learning rates
 and pay less attention to the initialization parameters. Batch 
normalization additionally acts as a regularizer, reducing (and 
sometimes even eliminating) the need for Dropout.</p>

<h2 id="earlystopping">Early stopping</h2>

<p>According to Geoff Hinton: "<em>Early stopping (is) beautiful free lunch</em>" (<a href="http://www.iro.umontreal.ca/~bengioy/talks/DL-Tutorial-NIPS2015.pdf">NIPS 2015 Tutorial slides</a>,
 slide 63). You should thus always monitor error on a validation set 
during training and stop (with some patience) if your validation error 
does not improve enough.</p>

<h2 id="gradientnoise">Gradient noise</h2>

<p>Neelakantan et al. [<sup id="fnref:21"><a href="http://ruder.io/optimizing-gradient-descent/index.html#fn:21" rel="footnote">21</a></sup>] add noise that follows a Gaussian distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2521" style="width: 4.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.654em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.56em, 2.69em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2522"><span class="mi" id="MathJax-Span-2523" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-2524" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2525" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2526" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2527" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.57em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2528" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.622em;"><span class="mn" id="MathJax-Span-2529" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.571em;"><span class="mi" id="MathJax-Span-2530" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2531" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.557em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-155">N(0, \sigma^2_t)</script> to each gradient update:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2532" style="width: 11.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.702em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1008.61em, 2.691em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2533"><span class="msubsup" id="MathJax-Span-2534"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2535" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-2536"><span class="mrow" id="MathJax-Span-2537"><span class="mi" id="MathJax-Span-2538" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2539" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2540" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2541" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-2542" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.248em; height: 0px;"><span style="position: absolute; clip: rect(3.404em, 1000.48em, 4.34em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2543" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.477em;"><span class="texatom" id="MathJax-Span-2544"><span class="mrow" id="MathJax-Span-2545"><span class="mi" id="MathJax-Span-2546" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-2547" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2548" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2549" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2550" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-2551" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2552" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2553" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2554" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.57em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2555" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.622em;"><span class="mn" id="MathJax-Span-2556" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.571em;"><span class="mi" id="MathJax-Span-2557" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2558" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.436em; border-left: 0px solid; width: 0px; height: 1.558em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-156">g_{t, i} = g_{t, i} + N(0, \sigma^2_t)</script>.</p>

<p>They anneal the variance according to the following schedule:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2559" style="width: 7.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.058em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.997em, 1006.06em, 3.364em, -1000em); top: -2.26em; left: 0em;"><span class="mrow" id="MathJax-Span-2560"><span class="msubsup" id="MathJax-Span-2561"><span style="display: inline-block; position: relative; width: 1.051em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.57em, 4.146em, -1000em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-2562" style="font-family: MathJax_Math; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.375em, 1000.43em, 4.135em, -1000em); top: -4.335em; left: 0.622em;"><span class="mn" id="MathJax-Span-2563" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.404em, 1000.33em, 4.142em, -1000em); top: -3.712em; left: 0.571em;"><span class="mi" id="MathJax-Span-2564" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2565" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mstyle" id="MathJax-Span-2566" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-2567"><span class="mfrac" id="MathJax-Span-2568"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.404em, 1000.5em, 4.351em, -1000em); top: -4.667em; left: 50%; margin-left: -0.252em;"><span class="mi" id="MathJax-Span-2569" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1003.32em, 4.385em, -1000em); top: -3.28em; left: 50%; margin-left: -1.66em;"><span class="mrow" id="MathJax-Span-2570"><span class="mo" id="MathJax-Span-2571" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2572" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2573" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-2574" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">t</span><span class="msubsup" id="MathJax-Span-2575"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.29em, 4.385em, -1000em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-2576" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.279em; left: 0.389em;"><span class="mi" id="MathJax-Span-2577" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.853em, 1003.44em, 1.202em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.44em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.26em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.311em; border-left: 0px solid; width: 0px; height: 2.827em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mi>γ</mi></msup></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-157"> \sigma^2_t = \dfrac{\eta}{(1 + t)^\gamma} </script>.</p>

<p>They show that adding this noise makes networks more robust to poor 
initialization and helps training particularly deep and complex 
networks. They suspect that the added noise gives the model more chances
 to escape and find new local minima, which are more frequent for deeper
 models.</p>

<h1 id="conclusion">Conclusion</h1>

<p>In this blog post, we have initially looked at the three variants of 
gradient descent, among which mini-batch gradient descent is the most 
popular. We have then investigated algorithms that are most commonly 
used for optimizing SGD: Momentum, Nesterov accelerated gradient, 
Adagrad, Adadelta, RMSprop, Adam, as well as different algorithms to 
optimize asynchronous SGD. Finally, we've considered other strategies to
 improve SGD such as shuffling and curriculum learning, batch 
normalization, and early stopping.</p>

<p>I hope that this blog post was able to provide you with some 
intuitions towards the motivation and the behaviour of the different 
optimization algorithms. Are there any obvious algorithms to improve SGD
 that I've missed? What tricks are you using yourself to facilitate 
training with SGD? <strong>Let me know in the comments below.</strong></p>

<h1 id="acknowledgements">Acknowledgements</h1>

<p>Thanks to <a href="https://twitter.com/dennybritz">Denny Britz</a> and <a href="https://twitter.com/cesarsvs">Cesar Salgado</a> for reading drafts of this post and providing suggestions.</p>

<h1 id="printableversionandcitation">Printable version and citation</h1>

<p>This blog post is also available as an <a href="http://arxiv.org/abs/1609.04747">article on arXiv</a>, in case you want to refer to it later.</p>

<p>In case you found it helpful, consider citing the corresponding arXiv article as: <br>
<em>Sebastian Ruder (2016). An overview of gradient descent optimisation algorithms. arXiv preprint arXiv:1609.04747.</em></p>

<h1 id="translations">Translations</h1>

<p>This blog post has been translated into the following languages:</p>

<ul>
<li><a href="http://postd.cc/optimizing-gradient-descent/">Japanese</a></li>
<li><a href="http://blog.csdn.net/google19890102/article/details/69942970">Chinese</a></li>
<li><a href="https://brunch.co.kr/@chris-song/50">Korean</a></li>
</ul>

<p>Update 21.06.16: This post was posted to Hacker News. <a href="https://news.ycombinator.com/item?id=11943685">The discussion</a> provides some interesting pointers to related work and other techniques.</p>

<h1 id="references">References</h1>

<div class="footnotes"><ol><li class="footnote" id="fn:1"><p>Sutton, R. 
S. (1986). Two problems with backpropagation and other steepest-descent 
learning procedures for networks. Proc. 8th Annual Conf. Cognitive 
Science Society. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:1" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:2"><p>Qian, N. (1999). On the momentum term 
in gradient descent learning algorithms. Neural Networks : The Official 
Journal of the International Neural Network Society, 12(1), 145–151. <a href="http://doi.org/10.1016/S0893-6080(98)00116-6">http://doi.org/10.1016/S0893-6080(98)00116-6</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:2" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:3"><p>Duchi, J., Hazan, E., &amp; Singer, Y.
 (2011). Adaptive Subgradient Methods for Online Learning and Stochastic
 Optimization. Journal of Machine Learning Research, 12, 2121–2159. 
Retrieved from <a href="http://jmlr.org/papers/v12/duchi11a.html">http://jmlr.org/papers/v12/duchi11a.html</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:3" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:4"><p>Dean, J., Corrado, G. S., Monga, R., 
Chen, K., Devin, M., Le, Q. V, … Ng, A. Y. (2012). Large Scale 
Distributed Deep Networks. NIPS 2012: Neural Information Processing 
Systems, 1–11. <a href="http://papers.nips.cc/paper/4687-large-scale-distributed-deep-networks.pdf">http://papers.nips.cc/paper/4687-large-scale-distributed-deep-networks.pdf</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:4" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:5"><p>Pennington, J., Socher, R., &amp; 
Manning, C. D. (2014). Glove: Global Vectors for Word Representation. 
Proceedings of the 2014 Conference on Empirical Methods in Natural 
Language Processing, 1532–1543. <a href="http://doi.org/10.3115/v1/D14-1162">http://doi.org/10.3115/v1/D14-1162</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:5" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:6"><p>Zeiler, M. D. (2012). ADADELTA: An Adaptive Learning Rate Method. Retrieved from <a href="http://arxiv.org/abs/1212.5701">http://arxiv.org/abs/1212.5701</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:6" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:7"><p>Nesterov, Y. (1983). A method for 
unconstrained convex minimization problem with the rate of convergence 
o(1/k2). Doklady ANSSSR (translated as Soviet.Math.Docl.), vol. 269, pp.
 543– 547. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:7" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:8"><p>Bengio, Y., Boulanger-Lewandowski, N., &amp; Pascanu, R. (2012). Advances in Optimizing Recurrent Networks. Retrieved from <a href="http://arxiv.org/abs/1212.0901">http://arxiv.org/abs/1212.0901</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:8" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:9"><p>Sutskever, I. (2013). Training Recurrent neural Networks. PhD Thesis. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:9" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:10"><p>Darken, C., Chang, J., &amp; Moody, 
J. (1992). Learning rate schedules for faster stochastic gradient 
search. Neural Networks for Signal Processing II Proceedings of the 1992
 IEEE Workshop, (September), 1–11. <a href="http://doi.org/10.1109/NNSP.1992.253713">http://doi.org/10.1109/NNSP.1992.253713</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:10" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:11"><p>H. Robinds and S. Monro, “A stochastic approximation method,” Annals of Mathematical Statistics, vol. 22, pp. 400–407, 1951. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:11" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:12"><p>Mcmahan, H. B., &amp; Streeter, M. 
(2014). Delay-Tolerant Algorithms for Asynchronous Distributed Online 
Learning. Advances in Neural Information Processing Systems (Proceedings
 of NIPS), 1–9. Retrieved from <a href="http://papers.nips.cc/paper/5242-delay-tolerant-algorithms-for-asynchronous-distributed-online-learning.pdf">http://papers.nips.cc/paper/5242-delay-tolerant-algorithms-for-asynchronous-distributed-online-learning.pdf</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:12" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:13"><p>Abadi, M., Agarwal, A., Barham, P., 
Brevdo, E., Chen, Z., Citro, C., … Zheng, X. (2015). TensorFlow : 
Large-Scale Machine Learning on Heterogeneous Distributed Systems. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:13" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:14"><p>Zhang, S., Choromanska, A., &amp; 
LeCun, Y. (2015). Deep learning with Elastic Averaging SGD. Neural 
Information Processing Systems Conference (NIPS 2015), 1–24. Retrieved 
from <a href="http://arxiv.org/abs/1412.6651">http://arxiv.org/abs/1412.6651</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:14" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:15"><p>Kingma, D. P., &amp; Ba, J. L. 
(2015). Adam: a Method for Stochastic Optimization. International 
Conference on Learning Representations, 1–13. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:15" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:16"><p>Bengio, Y., Louradour, J., Collobert,
 R., &amp; Weston, J. (2009). Curriculum learning. Proceedings of the 
26th Annual International Conference on Machine Learning, 41–48. <a href="http://doi.org/10.1145/1553374.1553380">http://doi.org/10.1145/1553374.1553380</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:16" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:17"><p>Zaremba, W., &amp; Sutskever, I. (2014). Learning to Execute, 1–25. Retrieved from <a href="http://arxiv.org/abs/1410.4615">http://arxiv.org/abs/1410.4615</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:17" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:18"><p>Ioffe, S., &amp; Szegedy, C. (2015). 
Batch Normalization : Accelerating Deep Network Training by Reducing 
Internal Covariate Shift. arXiv Preprint arXiv:1502.03167v3. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:18" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:19"><p>Dauphin, Y., Pascanu, R., Gulcehre, 
C., Cho, K., Ganguli, S., &amp; Bengio, Y. (2014). Identifying and 
attacking the saddle point problem in high-dimensional non-convex 
optimization. arXiv, 1–14. Retrieved from <a href="http://arxiv.org/abs/1406.2572">http://arxiv.org/abs/1406.2572</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:19" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:20"><p>Sutskever, I., &amp; Martens, J. (2013). On the importance of initialization and momentum in deep learning. <a href="http://doi.org/10.1109/ICASSP.2013.6639346">http://doi.org/10.1109/ICASSP.2013.6639346</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:20" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:21"><p>Neelakantan, A., Vilnis, L., Le, Q. 
V., Sutskever, I., Kaiser, L., Kurach, K., &amp; Martens, J. (2015). 
Adding Gradient Noise Improves Learning for Very Deep Networks, 1–11. 
Retrieved from <a href="http://arxiv.org/abs/1511.06807">http://arxiv.org/abs/1511.06807</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:21" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:22"><p>LeCun, Y., Bottou, L., Orr, G. B., 
&amp; Müller, K. R. (1998). Efficient BackProp. Neural Networks: Tricks 
of the Trade, 1524, 9–50. <a href="http://doi.org/10.1007/3-540-49430-8_2">http://doi.org/10.1007/3-540-49430-8_2</a> <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:22" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:23"><p>Niu, F., Recht, B., Christopher, R., 
&amp; Wright, S. J. (2011). Hogwild! : A Lock-Free Approach to 
Parallelizing Stochastic Gradient Descent, 1–22. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:23" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:24"><p>Dozat, T. (2016). Incorporating Nesterov Momentum into Adam. ICLR Workshop, (1), 2013–2016. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:24" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:25"><p>Duchi et al. [3] give this matrix as an alternative to the <em>full</em>
 matrix containing the outer products of all previous gradients, as the 
computation of the matrix square root is infeasible even for a moderate 
number of parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2578" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.529em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.133em, 1000.53em, 2.125em, -1000em); top: -1.971em; left: 0em;"><span class="mrow" id="MathJax-Span-2579"><span class="mi" id="MathJax-Span-2580" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.971em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.075em; border-left: 0px solid; width: 0px; height: 1.04em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-158">d</script>. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:25" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:26"><p>Huang, G., Liu, Z., Weinberger, K. 
Q., &amp; van der Maaten, L. (2017). Densely Connected Convolutional 
Networks. In Proceedings of CVPR 2017. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:26" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:27"><p>Johnson, M., Schuster, M., Le, Q. V, 
Krikun, M., Wu, Y., Chen, Z., … Dean, J. (2016). Google’s Multilingual 
Neural Machine Translation System: Enabling Zero-Shot Translation. arXiv
 Preprint arXiv:1611.0455. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:27" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li>
<li class="footnote" id="fn:28"><p>Reddi, Sashank J., Kale, Satyen, &amp; Kumar, Sanjiv. On the Convergence of Adam and Beyond. Proceedings of ICLR 2018. <a href="http://ruder.io/optimizing-gradient-descent/index.html#fnref:28" title="return to article"><img draggable="false" class="emoji" alt="↩" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/21a9.svg"></a></p></li></ol></div>

<p>Image credit for cover photo: <a href="http://lossfunctions.tumblr.com/">Karpathy's beautiful loss functions tumblr</a></p>
    </div>

    <div class="post related">

        <a rel="next" id="next-btn" class="btn small square" href="http://ruder.io/word-embeddings-1/">On word embeddings - Part 1 →</a>
    </div>

    <footer class="post comments">
  <div id="disqus_thread"><iframe id="dsq-app3996" name="dsq-app3996" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 7534px !important;" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/a.html" horizontalscrolling="no" verticalscrolling="no" width="100%" frameborder="0"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 783px !important; border: medium none !important; overflow: hidden !important; top: 0px !important; min-width: 783px !important; max-width: 783px !important; position: fixed !important; z-index: 2147483646 !important; height: 19px !important; min-height: 19px !important; max-height: 19px !important; display: none !important;" frameborder="0"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 783px !important; border: medium none !important; overflow: hidden !important; bottom: 0px !important; min-width: 783px !important; max-width: 783px !important; position: fixed !important; z-index: 2147483646 !important; height: 19px !important; min-height: 19px !important; max-height: 19px !important; display: none !important;" frameborder="0"></iframe></div>
  <script type="text/javascript">
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + window.disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  
</footer>

  </article>


<script src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/MathJax.js" id=""></script>  

        <footer>
  <span class="copyright">
    © 2018. All rights reserved. Built with <a href="https://ghost.org/" target="_blank">Ghost</a> and <a href="https://github.com/Kikobeats/uno-zen" target="_blank">Uno Zen</a> theme.
  </span>
</footer>
      </section>
    </main>
    <script type="text/javascript" src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/zepto.js"></script>
<script>jQuery = Zepto</script>
    <script src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/uno-zen.js" type="text/javascript" charset="utf-8"></script>
    <script src="An%20overview%20of%20gradient%20descent%20optimization%20algorithms_files/MathJax.js" id=""></script>
    <script>
  if (window.ga_id) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', window.ga_id, 'auto');
    ga('require', 'linkid', 'linkid.js');
    ga('send', 'pageview');
  }
</script>
  
<iframe style="display: none;"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_AMS, sans-serif;"></div></div></body></html>